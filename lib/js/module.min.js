/*!
module.js v1.4
(C) various
licence: various
*/
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function($){var e,t,i,a,n,r,s,l,o,c,d,u,h,p,m,f,v,g,_,k,y,b,x,w,T,M,D,F,z,C,S=(t={showEvent:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},colorScheme:"light",color:"3289c7",livePreview:!0,flat:!1,layout:"full",submit:1,submitText:"OK",height:156,polyfill:!1},i=function(e,t){var i=A(e);$(t).data("colpick").fields.eq(1).val(i.r).end().eq(2).val(i.g).end().eq(3).val(i.b).end()},a=function(e,t){$(t).data("colpick").fields.eq(4).val(Math.round(e.h)).end().eq(5).val(Math.round(e.s)).end().eq(6).val(Math.round(e.b)).end()},n=function(e,t){$(t).data("colpick").fields.eq(0).val(U(e))},r=function(e,t){$(t).data("colpick").selector.css("backgroundColor","#"+U({h:e.h,s:100,b:100})),$(t).data("colpick").selectorIndic.css({left:parseInt($(t).data("colpick").height*e.s/100,10),top:parseInt($(t).data("colpick").height*(100-e.b)/100,10)})},s=function(e,t){$(t).data("colpick").hue.css("top",parseInt($(t).data("colpick").height-$(t).data("colpick").height*e.h/360,10))},l=function(e,t){$(t).data("colpick").currentColor.css("backgroundColor","#"+U(e))},o=function(e,t){$(t).data("colpick").newColor.css("backgroundColor","#"+U(e))},c=function(e){var t,l=$(this).parent().parent();this.parentNode.className.indexOf("_hex")>0?(l.data("colpick").color=t=I(F(this.value)),i(t,l.get(0)),a(t,l.get(0))):this.parentNode.className.indexOf("_hsb")>0?(l.data("colpick").color=t=M({h:parseInt(l.data("colpick").fields.eq(4).val(),10),s:parseInt(l.data("colpick").fields.eq(5).val(),10),b:parseInt(l.data("colpick").fields.eq(6).val(),10)}),i(t,l.get(0)),n(t,l.get(0))):(l.data("colpick").color=t=O(D({r:parseInt(l.data("colpick").fields.eq(1).val(),10),g:parseInt(l.data("colpick").fields.eq(2).val(),10),b:parseInt(l.data("colpick").fields.eq(3).val(),10)})),n(t,l.get(0)),a(t,l.get(0))),r(t,l.get(0)),s(t,l.get(0)),o(t,l.get(0)),l.data("colpick").onChange.apply(l.parent(),[t,U(t),A(t),l.data("colpick").el,0])},d=function(e){$(this).parent().removeClass("colpick_focus")},u=function(){$(this).parent().parent().data("colpick").fields.parent().removeClass("colpick_focus"),$(this).parent().addClass("colpick_focus")},h=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=$(this).parent().find("input").focus(),i={el:$(this).parent().addClass("colpick_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:e.pageY,field:t,val:parseInt(t.val(),10),preview:$(this).parent().parent().data("colpick").livePreview};$(document).mouseup(i,m),$(document).mousemove(i,p)},p=function(e){return e.data.field.val(Math.max(0,Math.min(e.data.max,parseInt(e.data.val-e.pageY+e.data.y,10)))),e.data.preview&&c.apply(e.data.field.get(0),[!0]),!1},m=function(e){return c.apply(e.data.field.get(0),[!0]),e.data.el.removeClass("colpick_slider").find("input").focus(),$(document).off("mouseup",m),$(document).off("mousemove",p),!1},f=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t={cal:$(this).parent(),y:$(this).offset().top};$(document).on("mouseup touchend",t,g),$(document).on("mousemove touchmove",t,v);var i="touchstart"==e.type?e.originalEvent.changedTouches[0].pageY:e.pageY;return c.apply(t.cal.data("colpick").fields.eq(4).val(parseInt(360*(t.cal.data("colpick").height-(i-t.y))/t.cal.data("colpick").height,10)).get(0),[t.cal.data("colpick").livePreview]),!1},v=function(e){var t="touchmove"==e.type?e.originalEvent.changedTouches[0].pageY:e.pageY;return c.apply(e.data.cal.data("colpick").fields.eq(4).val(parseInt(360*(e.data.cal.data("colpick").height-Math.max(0,Math.min(e.data.cal.data("colpick").height,t-e.data.y)))/e.data.cal.data("colpick").height,10)).get(0),[e.data.preview]),!1},g=function(e){return i(e.data.cal.data("colpick").color,e.data.cal.get(0)),n(e.data.cal.data("colpick").color,e.data.cal.get(0)),$(document).off("mouseup touchend",g),$(document).off("mousemove touchmove",v),!1},_=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t,i,a={cal:$(this).parent(),pos:$(this).offset()};return a.preview=a.cal.data("colpick").livePreview,$(document).on("mouseup touchend",a,y),$(document).on("mousemove touchmove",a,k),"touchstart"==e.type?(t=e.originalEvent.changedTouches[0].pageX,i=e.originalEvent.changedTouches[0].pageY):(t=e.pageX,i=e.pageY),c.apply(a.cal.data("colpick").fields.eq(6).val(parseInt(100*(a.cal.data("colpick").height-(i-a.pos.top))/a.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*(t-a.pos.left)/a.cal.data("colpick").height,10)).get(0),[a.preview]),!1},k=function(e){var t,i;return"touchmove"==e.type?(t=e.originalEvent.changedTouches[0].pageX,i=e.originalEvent.changedTouches[0].pageY):(t=e.pageX,i=e.pageY),c.apply(e.data.cal.data("colpick").fields.eq(6).val(parseInt(100*(e.data.cal.data("colpick").height-Math.max(0,Math.min(e.data.cal.data("colpick").height,i-e.data.pos.top)))/e.data.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(e.data.cal.data("colpick").height,t-e.data.pos.left))/e.data.cal.data("colpick").height,10)).get(0),[e.data.preview]),!1},y=function(e){return i(e.data.cal.data("colpick").color,e.data.cal.get(0)),n(e.data.cal.data("colpick").color,e.data.cal.get(0)),$(document).off("mouseup touchend",y),$(document).off("mousemove touchmove",k),!1},b=function(e){var t=$(this).parent(),i=t.data("colpick").color;t.data("colpick").origColor=i,l(i,t.get(0)),t.data("colpick").onSubmit(i,U(i),A(i),t.data("colpick").el)},x=function(e){e&&e.stopPropagation();var t=$("#"+$(this).data("colpickId"));e&&!t.data("colpick").polyfill&&e.preventDefault(),t.data("colpick").onBeforeShow.apply(this,[t.get(0)]);var i=$(this).offset(),a=i.top+this.offsetHeight,n=i.left,r=T(),s=t.width();n+s>r.l+r.w&&(n-=s),t.css({left:n+"px",top:a+"px"}),0!=t.data("colpick").onShow.apply(this,[t.get(0)])&&t.show(),$("html").mousedown({cal:t},w),t.mousedown(function(e){e.stopPropagation()})},w=function(e){var t=$("#"+$(this).data("colpickId"));e&&(t=e.data.cal),0!=t.data("colpick").onHide.apply(this,[t.get(0)])&&t.hide(),$("html").off("mousedown",w)},T=function(){var e="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(e?document.documentElement.scrollLeft:document.body.scrollLeft),w:window.innerWidth||(e?document.documentElement.clientWidth:document.body.clientWidth)}},M=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},D=function(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}},F=function(e){var t=6-e.length;if(3==t){for(var i=[],a=0;a<t;a++)i.push(e[a]),i.push(e[a]);e=i.join("")}else if(t>0){for(var n=[],r=0;r<t;r++)n.push("0");n.push(e),e=n.join("")}return e},e=0,z=function(){return e+=1},C=function(){var e=$(this).parent(),t=e.data("colpick").origColor;e.data("colpick").color=t,i(t,e.get(0)),n(t,e.get(0)),a(t,e.get(0)),r(t,e.get(0)),s(t,e.get(0)),o(t,e.get(0))},{init:function(e){if("string"==typeof(e=$.extend({},t,e||{})).color)e.color=I(e.color);else if(null!=e.color.r&&null!=e.color.g&&null!=e.color.b)e.color=O(e.color);else{if(null==e.color.h||null==e.color.s||null==e.color.b)return this;e.color=M(e.color)}return this.each(function(){if(!$(this).data("colpickId")){var t=$.extend({},e);if(t.origColor=e.color,"function"==typeof e.polyfill&&(t.polyfill=e.polyfill(this)),t.input=$(this).is("input"),t.polyfill&&t.input&&"color"===this.type)return;var p="colorpicker_"+z();$(this).data("colpickId",p);var m=$('<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"><div class="colpick_selector_inner"></div></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_new_color"></div><div class="colpick_current_color"></div><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_submit"></div></div>').attr("id",p);m.addClass("colpick_"+t.layout+(t.submit?"":" colpick_"+t.layout+"_ns")),"light"!=t.colorScheme&&m.addClass("colpick_"+t.colorScheme),m.find("div.colpick_submit").html(t.submitText).click(b),t.fields=m.find("input").change(c).blur(d).focus(u),m.find("div.colpick_field_arrs").mousedown(h).end().find("div.colpick_current_color").click(C),t.selector=m.find("div.colpick_color").on("mousedown touchstart",_),t.selectorIndic=t.selector.find("div.colpick_selector_outer"),t.el=this,t.hue=m.find("div.colpick_hue_arrs");var v=t.hue.parent(),g=navigator.userAgent.toLowerCase(),k="Microsoft Internet Explorer"===navigator.appName,y=k?parseFloat(g.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0,w=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(k&&y<10){var T,M;for(T=0;T<=11;T++)M=$("<div></div>").attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+w[T]+", endColorstr="+w[T+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+w[T]+", endColorstr="+w[T+1]+')";'),v.append(M)}else{var D=w.join(",");v.attr("style","background:-webkit-linear-gradient(top,"+D+"); background: -o-linear-gradient(top,"+D+"); background: -ms-linear-gradient(top,"+D+"); background:-moz-linear-gradient(top,"+D+"); -webkit-linear-gradient(top,"+D+"); background:linear-gradient(to bottom,"+D+"); ")}m.find("div.colpick_hue").on("mousedown touchstart",f),t.newColor=m.find("div.colpick_new_color"),t.currentColor=m.find("div.colpick_current_color"),m.data("colpick",t),i(t.color,m.get(0)),a(t.color,m.get(0)),n(t.color,m.get(0)),s(t.color,m.get(0)),r(t.color,m.get(0)),l(t.color,m.get(0)),o(t.color,m.get(0)),t.flat?(m.appendTo(this).show(),m.css({position:"relative",display:"block"})):(m.appendTo($(this).parent()),$(this).on(t.showEvent,x),m.css({position:"absolute"}))}})},showPicker:function(){return this.each(function(){$(this).data("colpickId")&&x.apply(this)})},hidePicker:function(){return this.each(function(){$(this).data("colpickId")&&w.apply(this)})},setColor:function(e,t){if(null!=e){if(t=void 0===t?1:t,"string"==typeof e)e=I(e);else if(null!=e.r&&null!=e.g&&null!=e.b)e=O(e);else{if(null==e.h||null==e.s||null==e.b)return this;e=M(e)}return this.each(function(){if($(this).data("colpickId")){var c=$("#"+$(this).data("colpickId"));c.data("colpick").color=e,c.data("colpick").origColor=e,i(e,c.get(0)),a(e,c.get(0)),n(e,c.get(0)),s(e,c.get(0)),r(e,c.get(0)),o(e,c.get(0)),c.data("colpick").onChange.apply(c.parent(),[e,U(e),A(e),c.data("colpick").el,1]),t&&l(e,c.get(0))}})}},destroy:function(e,t){$("#"+$(this).data("colpickId")).remove()}}),E=function(e){return{r:(e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16))>>16,g:(65280&e)>>8,b:255&e}},I=function(e){return O(E(e))},O=function(e){var t={h:0,s:0,b:0},i=Math.min(e.r,e.g,e.b),a=Math.max(e.r,e.g,e.b),n=a-i;return t.b=a,t.s=0!=a?255*n/a:0,0!=t.s?e.r==a?t.h=(e.g-e.b)/n:e.g==a?t.h=2+(e.b-e.r)/n:t.h=4+(e.r-e.g)/n:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t},A=function(e){var t={},i=e.h,a=255*e.s/100,n=255*e.b/100;if(0==a)t.r=t.g=t.b=n;else{var r=n,s=(255-a)*n/255,l=i%60*(r-s)/60;360==i&&(i=0),i<60?(t.r=r,t.b=s,t.g=s+l):i<120?(t.g=r,t.b=s,t.r=r-l):i<180?(t.g=r,t.r=s,t.b=s+l):i<240?(t.b=r,t.r=s,t.g=r-l):i<300?(t.b=r,t.g=s,t.r=s+l):i<360?(t.r=r,t.g=s,t.b=r-l):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}},L=function(e){var t=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return $.each(t,function(e,i){1==i.length&&(t[e]="0"+i)}),t.join("")},U=function(e){return L(A(e))};$.fn.extend({colpick:S.init,colpickHide:S.hidePicker,colpickShow:S.showPicker,colpickSetColor:S.setColor,colpickDestroy:S.destroy}),$.extend({colpick:{rgbToHex:L,rgbToHsb:O,hsbToHex:U,hsbToRgb:A,hexToHsb:I,hexToRgb:E}})}),function($){if($.ui.timepicker=$.ui.timepicker||{},!$.ui.timepicker.version){$.extend($.ui,{timepicker:{version:"1.1.1"}}),$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,timezone:null,defaultTimezone:"+0000",hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec"],control:null,setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_newInst:function($input,o){var tp_inst=new Timepicker,inlineSettings={},fns={},overrides,i;for(var attrName in this._defaults)if(this._defaults.hasOwnProperty(attrName)){var attrValue=$input.attr("time:"+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(e){inlineSettings[attrName]=attrValue}}for(i in overrides={beforeShow:function(e,t){if($.isFunction(tp_inst._defaults.evnts.beforeShow))return tp_inst._defaults.evnts.beforeShow.call($input[0],e,t,tp_inst)},onChangeMonthYear:function(e,t,i){tp_inst._updateDateTime(i),$.isFunction(tp_inst._defaults.evnts.onChangeMonthYear)&&tp_inst._defaults.evnts.onChangeMonthYear.call($input[0],e,t,i,tp_inst)},onClose:function(e,t){!0===tp_inst.timeDefined&&""!==$input.val()&&tp_inst._updateDateTime(t),$.isFunction(tp_inst._defaults.evnts.onClose)&&tp_inst._defaults.evnts.onClose.call($input[0],e,t,tp_inst)}},overrides)overrides.hasOwnProperty(i)&&(fns[i]=o[i]||null);if(tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,overrides,{evnts:fns,timepicker:tp_inst}),tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(e){return e.toUpperCase()}),tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(e){return e.toUpperCase()}),"string"==typeof tp_inst._defaults.controlType?(void 0===$.fn[tp_inst._defaults.controlType]&&(tp_inst._defaults.controlType="select"),tp_inst.control=tp_inst._controls[tp_inst._defaults.controlType]):tp_inst.control=tp_inst._defaults.controlType,null===tp_inst._defaults.timezoneList){var timezoneList=["-1200","-1100","-1000","-0930","-0900","-0800","-0700","-0600","-0500","-0430","-0400","-0330","-0300","-0200","-0100","+0000","+0100","+0200","+0300","+0330","+0400","+0430","+0500","+0530","+0545","+0600","+0630","+0700","+0800","+0845","+0900","+0930","+1000","+1030","+1100","+1130","+1200","+1245","+1300","+1400"];tp_inst._defaults.timezoneIso8601&&(timezoneList=$.map(timezoneList,function(e){return"+0000"==e?"Z":e.substring(0,3)+":"+e.substring(3)})),tp_inst._defaults.timezoneList=timezoneList}return tp_inst.timezone=tp_inst._defaults.timezone,tp_inst.hour=tp_inst._defaults.hour,tp_inst.minute=tp_inst._defaults.minute,tp_inst.second=tp_inst._defaults.second,tp_inst.millisec=tp_inst._defaults.millisec,tp_inst.ampm="",tp_inst.$input=$input,o.altField&&(tp_inst.$altInput=$(o.altField).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")})),0!==tp_inst._defaults.minDate&&0!==tp_inst._defaults.minDateTime||(tp_inst._defaults.minDate=new Date),0!==tp_inst._defaults.maxDate&&0!==tp_inst._defaults.maxDateTime||(tp_inst._defaults.maxDate=new Date),void 0!==tp_inst._defaults.minDate&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())),void 0!==tp_inst._defaults.minDateTime&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())),void 0!==tp_inst._defaults.maxDate&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())),void 0!==tp_inst._defaults.maxDateTime&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())),tp_inst.$input.bind("focus",function(){tp_inst._onFocus()}),tp_inst},_addTimePicker:function(e){var t=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(t),this._limitMinMaxDateTime(e,!1),this._injectTimePicker()},_parseTime:function(e,t){if(this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),t||!this._defaults.timeOnly){var i=$.datepicker._get(this.inst,"dateFormat");try{var a=parseDateTimeInternal(i,this._defaults.timeFormat,e,$.datepicker._getFormatConfig(this.inst),this._defaults);if(!a.timeObj)return!1;$.extend(this,a.timeObj)}catch(t){return $.datepicker.log("Error parsing the date/time string: "+t+"\ndate/time string = "+e+"\ntimeFormat = "+this._defaults.timeFormat+"\ndateFormat = "+i),!1}return!0}var n=$.datepicker.parseTime(this._defaults.timeFormat,e,this._defaults);return!!n&&($.extend(this,n),!0)},_injectTimePicker:function(){var e=this.inst.dpDiv,t=this.inst.settings,i=this,a="",n="",r={},s={},l=null;if(0===e.find("div.ui-timepicker-div").length&&t.showTimepicker){for(var o=' style="display:none;"',c='<div class="ui-timepicker-div'+(t.isRTL?" ui-timepicker-rtl":"")+'"><dl><dt class="ui_tpicker_time_label"'+(t.showTime?"":o)+">"+t.timeText+'</dt><dd class="ui_tpicker_time"'+(t.showTime?"":o)+"></dd>",d=0,u=this.units.length;d<u;d++){if(n=(a=this.units[d]).substr(0,1).toUpperCase()+a.substr(1),r[a]=parseInt(t[a+"Max"]-(t[a+"Max"]-t[a+"Min"])%t["step"+n],10),s[a]=0,c+='<dt class="ui_tpicker_'+a+'_label"'+(t["show"+n]?"":o)+">"+t[a+"Text"]+'</dt><dd class="ui_tpicker_'+a+'"><div class="ui_tpicker_'+a+'_slider"'+(t["show"+n]?"":o)+"></div>",t["show"+n]&&t[a+"Grid"]>0){if(c+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>',"hour"==a)for(var h=t[a+"Min"];h<=r[a];h+=parseInt(t[a+"Grid"],10)){s[a]++;var p=$.datepicker.formatTime(useAmpm(t.pickerTimeFormat||t.timeFormat)?"hht":"HH",{hour:h},t);c+='<td data-for="'+a+'">'+p+"</td>"}else for(var m=t[a+"Min"];m<=r[a];m+=parseInt(t[a+"Grid"],10))s[a]++,c+='<td data-for="'+a+'">'+(m<10?"0":"")+m+"</td>";c+="</tr></table></div>"}c+="</dd>"}c+='<dt class="ui_tpicker_timezone_label"'+(t.showTimezone?"":o)+">"+t.timezoneText+"</dt>",c+='<dd class="ui_tpicker_timezone" '+(t.showTimezone?"":o)+"></dd>";var f=$(c+="</dl></div>");for(!0===t.timeOnly&&(f.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+t.timeOnlyTitle+"</div></div>"),e.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()),d=0,u=i.units.length;d<u;d++)n=(a=i.units[d]).substr(0,1).toUpperCase()+a.substr(1),i[a+"_slider"]=i.control.create(i,f.find(".ui_tpicker_"+a+"_slider"),a,i[a],t[a+"Min"],r[a],t["step"+n]),t["show"+n]&&t[a+"Grid"]>0&&(l=100*s[a]*t[a+"Grid"]/(r[a]-t[a+"Min"]),f.find(".ui_tpicker_"+a+" table").css({width:l+"%",marginLeft:t.isRTL?"0":l/(-2*s[a])+"%",marginRight:t.isRTL?l/(-2*s[a])+"%":"0",borderCollapse:"collapse"}).find("td").click(function(e){var t=$(this),n=t.html(),r=parseInt(n.replace(/[^0-9]/g),10),s=n.replace(/[^apm]/gi),l=t.data("for");"hour"==l&&(-1!==s.indexOf("p")&&r<12?r+=12:-1!==s.indexOf("a")&&12===r&&(r=0)),i.control.value(i,i[l+"_slider"],a,r),i._onTimeChange(),i._onSelectHandler()}).css({cursor:"pointer",width:100/s[a]+"%",textAlign:"center",overflow:"hidden"}));if(this.timezone_select=f.find(".ui_tpicker_timezone").append("<select></select>").find("select"),$.fn.append.apply(this.timezone_select,$.map(t.timezoneList,function(e,t){return $("<option />").val("object"==typeof e?e.value:e).text("object"==typeof e?e.label:e)})),void 0!==this.timezone&&null!==this.timezone&&""!==this.timezone){var v=new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12);$.timepicker.timeZoneOffsetString(v)==this.timezone?selectLocalTimeZone(i):this.timezone_select.val(this.timezone)}else void 0!==this.hour&&null!==this.hour&&""!==this.hour?this.timezone_select.val(t.defaultTimezone):selectLocalTimeZone(i);this.timezone_select.change(function(){i._defaults.useLocalTimezone=!1,i._onTimeChange()});var g=e.find(".ui-datepicker-buttonpane");if(g.length?g.before(f):e.append(f),this.$timeObj=f.find(".ui_tpicker_time"),null!==this.inst){var _=this.timeDefined;this._onTimeChange(),this.timeDefined=_}if(this._defaults.addSliderAccess){var k=this._defaults.sliderAccessArgs,y=this._defaults.isRTL;k.isRTL=y,setTimeout(function(){if(0===f.find(".ui-slider-access").length){f.find(".ui-slider:visible").sliderAccess(k);var e=f.find(".ui-slider-access:eq(0)").outerWidth(!0);e&&f.find("table:visible").each(function(){var t=$(this),i=t.outerWidth(),a=t.css(y?"marginRight":"marginLeft").toString().replace("%",""),n=i-e,r=a*n/i+"%",s={width:n,marginRight:0,marginLeft:0};s[y?"marginRight":"marginLeft"]=r,t.css(s)})}},10)}}},_limitMinMaxDateTime:function(e,t){var i=this._defaults,a=new Date(e.selectedYear,e.selectedMonth,e.selectedDay);if(this._defaults.showTimepicker){if(null!==$.datepicker._get(e,"minDateTime")&&void 0!==$.datepicker._get(e,"minDateTime")&&a){var n=$.datepicker._get(e,"minDateTime"),r=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0);null!==this.hourMinOriginal&&null!==this.minuteMinOriginal&&null!==this.secondMinOriginal&&null!==this.millisecMinOriginal||(this.hourMinOriginal=i.hourMin,this.minuteMinOriginal=i.minuteMin,this.secondMinOriginal=i.secondMin,this.millisecMinOriginal=i.millisecMin),e.settings.timeOnly||r.getTime()==a.getTime()?(this._defaults.hourMin=n.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=n.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=n.getSeconds(),this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=n.getMilliseconds()):(this.millisec<this._defaults.millisecMin&&(this.millisec=this._defaults.millisecMin),this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)}if(null!==$.datepicker._get(e,"maxDateTime")&&void 0!==$.datepicker._get(e,"maxDateTime")&&a){var s=$.datepicker._get(e,"maxDateTime"),l=new Date(s.getFullYear(),s.getMonth(),s.getDate(),0,0,0,0);null!==this.hourMaxOriginal&&null!==this.minuteMaxOriginal&&null!==this.secondMaxOriginal||(this.hourMaxOriginal=i.hourMax,this.minuteMaxOriginal=i.minuteMax,this.secondMaxOriginal=i.secondMax,this.millisecMaxOriginal=i.millisecMax),e.settings.timeOnly||l.getTime()==a.getTime()?(this._defaults.hourMax=s.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=s.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=s.getSeconds()):this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=s.getMilliseconds()):(this.millisec>this._defaults.millisecMax&&(this.millisec=this._defaults.millisecMax),this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)}if(void 0!==t&&!0===t){var o=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),c=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),d=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),u=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10);this.hour_slider&&(this.control.options(this,this.hour_slider,"hour",{min:this._defaults.hourMin,max:o}),this.control.value(this,this.hour_slider,"hour",this.hour)),this.minute_slider&&(this.control.options(this,this.minute_slider,"minute",{min:this._defaults.minuteMin,max:c}),this.control.value(this,this.minute_slider,"minute",this.minute)),this.second_slider&&(this.control.options(this,this.second_slider,"second",{min:this._defaults.secondMin,max:d}),this.control.value(this,this.second_slider,"second",this.second)),this.millisec_slider&&(this.control.options(this,this.millisec_slider,"millisec",{min:this._defaults.millisecMin,max:u}),this.control.value(this,this.millisec_slider,"millisec",this.millisec))}}},_onTimeChange:function(){var e=!!this.hour_slider&&this.control.value(this,this.hour_slider,"hour"),t=!!this.minute_slider&&this.control.value(this,this.minute_slider,"minute"),i=!!this.second_slider&&this.control.value(this,this.second_slider,"second"),a=!!this.millisec_slider&&this.control.value(this,this.millisec_slider,"millisec"),n=!!this.timezone_select&&this.timezone_select.val(),r=this._defaults,s=r.pickerTimeFormat||r.timeFormat,l=r.pickerTimeSuffix||r.timeSuffix;"object"==typeof e&&(e=!1),"object"==typeof t&&(t=!1),"object"==typeof i&&(i=!1),"object"==typeof a&&(a=!1),"object"==typeof n&&(n=!1),!1!==e&&(e=parseInt(e,10)),!1!==t&&(t=parseInt(t,10)),!1!==i&&(i=parseInt(i,10)),!1!==a&&(a=parseInt(a,10));var o=r[e<12?"amNames":"pmNames"][0],c=e!=this.hour||t!=this.minute||i!=this.second||a!=this.millisec||this.ampm.length>0&&e<12!=(-1!==$.inArray(this.ampm.toUpperCase(),this.amNames))||null===this.timezone&&n!=this.defaultTimezone||null!==this.timezone&&n!=this.timezone;c&&(!1!==e&&(this.hour=e),!1!==t&&(this.minute=t),!1!==i&&(this.second=i),!1!==a&&(this.millisec=a),!1!==n&&(this.timezone=n),this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0)),useAmpm(r.timeFormat)&&(this.ampm=o),this.formattedTime=$.datepicker.formatTime(r.timeFormat,this,r),this.$timeObj&&(s===r.timeFormat?this.$timeObj.text(this.formattedTime+l):this.$timeObj.text($.datepicker.formatTime(s,this,r)+l)),this.timeDefined=!0,c&&this._updateDateTime()},_onSelectHandler:function(){var e=this._defaults.onSelect||this.inst.settings.onSelect,t=this.$input?this.$input[0]:null;e&&t&&e.apply(t,[this.formattedDateTime,this])},_updateDateTime:function(e){e=this.inst||e;var t=$.datepicker._daylightSavingAdjust(new Date(e.selectedYear,e.selectedMonth,e.selectedDay)),i=$.datepicker._get(e,"dateFormat"),a=$.datepicker._getFormatConfig(e),n=null!==t&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(i,null===t?new Date:t,a);var r=this.formattedDate;if(!0===this._defaults.timeOnly?r=this.formattedTime:!0!==this._defaults.timeOnly&&(this._defaults.alwaysSetTime||n)&&(r+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=r,this._defaults.showTimepicker)if(this.$altInput&&!0===this._defaults.altFieldTimeOnly)this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate);else if(this.$altInput){this.$input.val(r);var s="",l=this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,o=this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;(s=this._defaults.altFormat?$.datepicker.formatDate(this._defaults.altFormat,null===t?new Date:t,a):this.formattedDate)&&(s+=l),this._defaults.altTimeFormat?s+=$.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+o:s+=this.formattedTime+o,this.$altInput.val(s)}else this.$input.val(r);else this.$input.val(this.formattedDate);this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var e=$.datepicker._getInst(this.$input.get(0)),t=$.datepicker._get(e,"timepicker");if(t&&t._defaults.timeOnly&&e.input.val()!=e.lastVal)try{$.datepicker._updateDatepicker(e)}catch(e){$.datepicker.log(e)}}},_controls:{slider:{create:function(e,t,i,a,n,r,s){var l=e._defaults.isRTL;return t.prop("slide",null).slider({orientation:"horizontal",value:l?-1*a:a,min:l?-1*r:n,max:l?-1*n:r,step:s,slide:function(t,a){e.control.value(e,$(this),i,l?-1*a.value:a.value),e._onTimeChange()},stop:function(t,i){e._onSelectHandler()}})},options:function(e,t,i,a,n){if(e._defaults.isRTL){if("string"==typeof a)return"min"==a||"max"==a?void 0!==n?t.slider(a,-1*n):Math.abs(t.slider(a)):t.slider(a);var r=a.min,s=a.max;return a.min=a.max=null,void 0!==r&&(a.max=-1*r),void 0!==s&&(a.min=-1*s),t.slider(a)}return"string"==typeof a&&void 0!==n?t.slider(a,n):t.slider(a)},value:function(e,t,i,a){return e._defaults.isRTL?void 0!==a?t.slider("value",-1*a):Math.abs(t.slider("value")):void 0!==a?t.slider("value",a):t.slider("value")}},select:{create:function(e,t,i,a,n,r,s){for(var l='<select class="ui-timepicker-select" data-unit="'+i+'" data-min="'+n+'" data-max="'+r+'" data-step="'+s+'">',o=(e._defaults.timeFormat.indexOf("t"),n);o<=r;o+=s)l+='<option value="'+o+'"'+(o==a?" selected":"")+">","hour"==i&&useAmpm(e._defaults.pickerTimeFormat||e._defaults.timeFormat)?l+=$.datepicker.formatTime("hh TT",{hour:o},e._defaults):l+="millisec"==i||o>=10?o:"0"+o.toString(),l+="</option>";return l+="</select>",t.children("select").remove(),$(l).appendTo(t).change(function(t){e._onTimeChange(),e._onSelectHandler()}),t},options:function(e,t,i,a,n){var r={},s=t.children("select");if("string"==typeof a){if(void 0===n)return s.data(a);r[a]=n}else r=a;return e.control.create(e,t,s.data("unit"),s.val(),r.min||s.data("min"),r.max||s.data("max"),r.step||s.data("step"))},value:function(e,t,i,a){var n=t.children("select");return void 0!==a?n.val(a):n.val()}}}}),$.fn.extend({timepicker:function(e){e=e||{};var t=Array.prototype.slice.call(arguments);return"object"==typeof e&&(t[0]=$.extend(e,{timeOnly:!0})),$(this).each(function(){$.fn.datetimepicker.apply($(this),t)})},datetimepicker:function(e){var t=arguments;return"string"==typeof(e=e||{})?"getDate"==e?$.fn.datepicker.apply($(this[0]),t):this.each(function(){var e=$(this);e.datepicker.apply(e,t)}):this.each(function(){var t=$(this);t.datepicker($.timepicker._newInst(t,e)._defaults)})}}),$.datepicker.parseDateTime=function(e,t,i,a,n){var r=parseDateTimeInternal(e,t,i,a,n);if(r.timeObj){var s=r.timeObj;r.date.setHours(s.hour,s.minute,s.second,s.millisec)}return r.date},$.datepicker.parseTime=function(e,t,i){var a=extendRemove(extendRemove({},$.timepicker._defaults),i||{}),n=function(e,t,i){var a,n="^"+e.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[lz]|'.*?')/g,function(e){switch(e.charAt(0).toLowerCase()){case"h":case"m":case"s":return"(\\d?\\d)";case"l":return"(\\d?\\d?\\d)";case"z":return"(z|[-+]\\d\\d:?\\d\\d|\\S+)?";case"t":return t=i.amNames,a=i.pmNames,n=[],t&&$.merge(n,t),a&&$.merge(n,a),"("+(n=$.map(n,function(e){return e.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")})).join("|")+")?";default:return"("+e.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(e){return"\\"+e})+")?"}var t,a,n}).replace(/\s/g,"\\s?")+i.timeSuffix+"$",r=function(e){var t=e.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|t{1,2}|z|'.*?')/g),i={h:-1,m:-1,s:-1,l:-1,t:-1,z:-1};if(t)for(var a=0;a<t.length;a++)-1==i[t[a].toString().charAt(0)]&&(i[t[a].toString().charAt(0)]=a+1);return i}(e),s="",l={hour:0,minute:0,second:0,millisec:0};if(a=t.match(new RegExp(n,"i"))){if(-1!==r.t&&(void 0===a[r.t]||0===a[r.t].length?(s="",l.ampm=""):(s=-1!==$.inArray(a[r.t].toUpperCase(),i.amNames)?"AM":"PM",l.ampm=i["AM"==s?"amNames":"pmNames"][0])),-1!==r.h&&("AM"==s&&"12"==a[r.h]?l.hour=0:"PM"==s&&"12"!=a[r.h]?l.hour=parseInt(a[r.h],10)+12:l.hour=Number(a[r.h])),-1!==r.m&&(l.minute=Number(a[r.m])),-1!==r.s&&(l.second=Number(a[r.s])),-1!==r.l&&(l.millisec=Number(a[r.l])),-1!==r.z&&void 0!==a[r.z]){var o=a[r.z].toUpperCase();switch(o.length){case 1:o=i.timezoneIso8601?"Z":"+0000";break;case 5:i.timezoneIso8601&&(o="0000"==o.substring(1)?"Z":o.substring(0,3)+":"+o.substring(3));break;case 6:i.timezoneIso8601?"00:00"==o.substring(1)&&(o="Z"):o="Z"==o||"00:00"==o.substring(1)?"+0000":o.replace(/:/,"")}l.timezone=o}return l}return!1};return"function"==typeof a.parse?a.parse(e,t,a):"loose"===a.parse?function(e,t,i){try{var a=new Date("2012-01-01 "+t);return{hour:a.getHours(),minutes:a.getMinutes(),seconds:a.getSeconds(),millisec:a.getMilliseconds(),timezone:$.timepicker.timeZoneOffsetString(a)}}catch(a){try{return n(e,t,i)}catch(i){$.datepicker.log("Unable to parse \ntimeString: "+t+"\ntimeFormat: "+e)}}return!1}(e,t,a):n(e,t,a)},$.datepicker.formatTime=function(e,t,i){i=i||{},i=$.extend({},$.timepicker._defaults,i),t=$.extend({hour:0,minute:0,second:0,millisec:0,timezone:"+0000"},t);var a=e,n=i.amNames[0],r=parseInt(t.hour,10);return r>11&&(n=i.pmNames[0]),a=a.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[lz]|('.*?'|".*?"))/g,function(e){switch(e){case"HH":return("0"+r).slice(-2);case"H":return r;case"hh":return("0"+convert24to12(r)).slice(-2);case"h":return convert24to12(r);case"mm":return("0"+t.minute).slice(-2);case"m":return t.minute;case"ss":return("0"+t.second).slice(-2);case"s":return t.second;case"l":return("00"+t.millisec).slice(-3);case"z":return null===t.timezone?i.defaultTimezone:t.timezone;case"T":return n.charAt(0).toUpperCase();case"TT":return n.toUpperCase();case"t":return n.charAt(0).toLowerCase();case"tt":return n.toLowerCase();default:return e.replace(/\'/g,"")||"'"}}),$.trim(a)},$.datepicker._base_selectDate=$.datepicker._selectDate,$.datepicker._selectDate=function(e,t){var i=this._getInst($(e)[0]),a=this._get(i,"timepicker");a?(a._limitMinMaxDateTime(i,!0),i.inline=i.stay_open=!0,this._base_selectDate(e,t),i.inline=i.stay_open=!1,this._notifyChange(i),this._updateDatepicker(i)):this._base_selectDate(e,t)},$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(e){var t=e.input[0];if(!($.datepicker._curInst&&$.datepicker._curInst!=e&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=t||"boolean"==typeof e.stay_open&&!1!==e.stay_open)){this._base_updateDatepicker(e);var i=this._get(e,"timepicker");if(i&&(i._addTimePicker(e),i._defaults.useLocalTimezone)){var a=new Date(e.selectedYear,e.selectedMonth,e.selectedDay,12);selectLocalTimeZone(i,a),i._onTimeChange()}}},$.datepicker._base_doKeyPress=$.datepicker._doKeyPress,$.datepicker._doKeyPress=function(e){var t=$.datepicker._getInst(e.target),i=$.datepicker._get(t,"timepicker");if(i&&$.datepicker._get(t,"constrainInput")){var a=useAmpm(i._defaults.timeFormat),n=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),r=i._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,a?"APM":"").replace(/Tt/g,a?"AaPpMm":"").replace(/tT/g,a?"AaPpMm":"").replace(/T/g,a?"AP":"").replace(/tt/g,a?"apm":"").replace(/t/g,a?"ap":"")+" "+i._defaults.separator+i._defaults.timeSuffix+(i._defaults.showTimezone?i._defaults.timezoneList.join(""):"")+i._defaults.amNames.join("")+i._defaults.pmNames.join("")+n,s=String.fromCharCode(void 0===e.charCode?e.keyCode:e.charCode);return e.ctrlKey||s<" "||!n||r.indexOf(s)>-1}return $.datepicker._base_doKeyPress(e)},$.datepicker._base_updateAlternate=$.datepicker._updateAlternate,$.datepicker._updateAlternate=function(e){var t=this._get(e,"timepicker");if(t){var i=t._defaults.altField;if(i){t._defaults.altFormat||t._defaults.dateFormat;var a=this._getDate(e),n=$.datepicker._getFormatConfig(e),r="",s=t._defaults.altSeparator?t._defaults.altSeparator:t._defaults.separator,l=t._defaults.altTimeSuffix?t._defaults.altTimeSuffix:t._defaults.timeSuffix,o=null!==t._defaults.altTimeFormat?t._defaults.altTimeFormat:t._defaults.timeFormat;r+=$.datepicker.formatTime(o,t,t._defaults)+l,t._defaults.timeOnly||t._defaults.altFieldTimeOnly||(r=t._defaults.altFormat?$.datepicker.formatDate(t._defaults.altFormat,null===a?new Date:a,n)+s+r:t.formattedDate+s+r),$(i).val(r)}}else $.datepicker._base_updateAlternate(e)},$.datepicker._base_doKeyUp=$.datepicker._doKeyUp,$.datepicker._doKeyUp=function(e){var t=$.datepicker._getInst(e.target),i=$.datepicker._get(t,"timepicker");if(i&&i._defaults.timeOnly&&t.input.val()!=t.lastVal)try{$.datepicker._updateDatepicker(t)}catch(e){$.datepicker.log(e)}return $.datepicker._base_doKeyUp(e)},$.datepicker._base_gotoToday=$.datepicker._gotoToday,$.datepicker._gotoToday=function(e){var t=this._getInst($(e)[0]),i=t.dpDiv;this._base_gotoToday(e);var a=this._get(t,"timepicker");selectLocalTimeZone(a);var n=new Date;this._setTime(t,n),$(".ui-datepicker-today",i).click()},$.datepicker._disableTimepickerDatepicker=function(e){var t=this._getInst(e);if(t){var i=this._get(t,"timepicker");$(e).datepicker("getDate"),i&&(i._defaults.showTimepicker=!1,i._updateDateTime(t))}},$.datepicker._enableTimepickerDatepicker=function(e){var t=this._getInst(e);if(t){var i=this._get(t,"timepicker");$(e).datepicker("getDate"),i&&(i._defaults.showTimepicker=!0,i._addTimePicker(t),i._updateDateTime(t))}},$.datepicker._setTime=function(e,t){var i=this._get(e,"timepicker");if(i){var a=i._defaults;i.hour=t?t.getHours():a.hour,i.minute=t?t.getMinutes():a.minute,i.second=t?t.getSeconds():a.second,i.millisec=t?t.getMilliseconds():a.millisec,i._limitMinMaxDateTime(e,!0),i._onTimeChange(),i._updateDateTime(e)}},$.datepicker._setTimeDatepicker=function(e,t,i){var a=this._getInst(e);if(a){var n,r=this._get(a,"timepicker");r&&(this._setDateFromField(a),t&&("string"==typeof t?(r._parseTime(t,i),(n=new Date).setHours(r.hour,r.minute,r.second,r.millisec)):n=new Date(t.getTime()),"Invalid Date"==n.toString()&&(n=void 0),this._setTime(a,n)))}},$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker,$.datepicker._setDateDatepicker=function(e,t){var i=this._getInst(e);if(i){var a=t instanceof Date?new Date(t.getTime()):t;this._updateDatepicker(i),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(e,a,!0)}},$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker,$.datepicker._getDateDatepicker=function(e,t){var i=this._getInst(e);if(i){var a=this._get(i,"timepicker");if(a){void 0===i.lastVal&&this._setDateFromField(i,t);var n=this._getDate(i);return n&&a._parseTime($(e).val(),a.timeOnly)&&n.setHours(a.hour,a.minute,a.second,a.millisec),n}return this._base_getDateDatepicker(e,t)}},$.datepicker._base_parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(e,t,i){var a;try{a=this._base_parseDate(e,t,i)}catch(n){a=this._base_parseDate(e,t.substring(0,t.length-(n.length-n.indexOf(":")-2)),i),$.datepicker.log("Error parsing the date string: "+n+"\ndate string = "+t+"\ndate format = "+e)}return a},$.datepicker._base_formatDate=$.datepicker._formatDate,$.datepicker._formatDate=function(e,t,i,a){var n=this._get(e,"timepicker");return n?(n._updateDateTime(e),n.$input.val()):this._base_formatDate(e)},$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker,$.datepicker._optionDatepicker=function(e,t,i){var a,n=this._getInst(e);if(!n)return null;var r=this._get(n,"timepicker");if(r){var s,l=null,o=null,c=null,d=r._defaults.evnts,u={};if("string"==typeof t){if("minDate"===t||"minDateTime"===t)l=i;else if("maxDate"===t||"maxDateTime"===t)o=i;else if("onSelect"===t)c=i;else if(d.hasOwnProperty(t)){if(void 0===i)return d[t];u[t]=i,a={}}}else if("object"==typeof t)for(s in t.minDate?l=t.minDate:t.minDateTime?l=t.minDateTime:t.maxDate?o=t.maxDate:t.maxDateTime&&(o=t.maxDateTime),d)d.hasOwnProperty(s)&&t[s]&&(u[s]=t[s]);for(s in u)u.hasOwnProperty(s)&&(d[s]=u[s],a||(a=$.extend({},t)),delete a[s]);if(a&&isEmptyObject(a))return;l?(l=0===l?new Date:new Date(l),r._defaults.minDate=l,r._defaults.minDateTime=l):o?(o=0===o?new Date:new Date(o),r._defaults.maxDate=o,r._defaults.maxDateTime=o):c&&(r._defaults.onSelect=c)}return void 0===i?this._base_optionDatepicker.call($.datepicker,e,t):this._base_optionDatepicker.call($.datepicker,e,a||t,i)};var isEmptyObject=function(e){var t;for(t in e)if(e.hasOwnProperty(e))return!1;return!0},extendRemove=function(e,t){for(var i in $.extend(e,t),t)null!==t[i]&&void 0!==t[i]||(e[i]=t[i]);return e},useAmpm=function(e){return-1!==e.indexOf("t")&&-1!==e.indexOf("h")},convert24to12=function(e){return e>12&&(e-=12),0==e&&(e=12),String(e)},splitDateTime=function(e,t,i,a){try{var n=a&&a.separator?a.separator:$.timepicker._defaults.separator,r=(a&&a.timeFormat?a.timeFormat:$.timepicker._defaults.timeFormat).split(n).length,s=t.split(n),l=s.length;if(l>1)return[s.splice(0,l-r).join(n),s.splice(0,r).join(n)]}catch(i){if($.datepicker.log("Could not split the date from the time. Please check the following datetimepicker options\nthrown error: "+i+"\ndateTimeString"+t+"\ndateFormat = "+e+"\nseparator = "+a.separator+"\ntimeFormat = "+a.timeFormat),i.indexOf(":")>=0){var o=t.length-(i.length-i.indexOf(":")-2);return t.substring(o),[$.trim(t.substring(0,o)),$.trim(t.substring(o))]}throw i}return[t,""]},parseDateTimeInternal=function(e,t,i,a,n){var r,s=splitDateTime(e,i,a,n);if(r=$.datepicker._base_parseDate(e,s[0],a),""!==s[1]){var l=s[1],o=$.datepicker.parseTime(t,l,n);if(null===o)throw"Wrong time format";return{date:r,timeObj:o}}return{date:r}},selectLocalTimeZone=function(e,t){if(e&&e.timezone_select){e._defaults.useLocalTimezone=!0;var i=void 0!==t?t:new Date,a=$.timepicker.timeZoneOffsetString(i);e._defaults.timezoneIso8601&&(a=a.substring(0,3)+":"+a.substring(3)),e.timezone_select.val(a)}};$.timepicker=new Timepicker,$.timepicker.timeZoneOffsetString=function(e){var t=-1*e.getTimezoneOffset(),i=t%60;return(t>=0?"+":"-")+("0"+((t-i)/60*101).toString()).substr(-2)+("0"+(101*i).toString()).substr(-2)},$.timepicker.timeRange=function(e,t,i){return $.timepicker.handleRange("timepicker",e,t,i)},$.timepicker.dateTimeRange=function(e,t,i){$.timepicker.dateRange(e,t,i,"datetimepicker")},$.timepicker.dateRange=function(e,t,i,a){a=a||"datepicker",$.timepicker.handleRange(a,e,t,i)},$.timepicker.handleRange=function(e,t,i,a){function n(e,a,n){a.val()&&new Date(t.val())>new Date(i.val())&&a.val(n)}function r(t,i,a){if($(t).val()){var n=$(t)[e].call($(t),"getDate");n.getTime&&$(i)[e].call($(i),"option",a,n)}}return $.fn[e].call(t,$.extend({onClose:function(e,t){n(0,i,e)},onSelect:function(e){r(this,i,"minDate")}},a,a.start)),$.fn[e].call(i,$.extend({onClose:function(e,i){n(0,t,e)},onSelect:function(e){r(this,t,"maxDate")}},a,a.end)),"timepicker"!=e&&a.reformat&&$([t,i]).each(function(){var t=$(this)[e].call($(this),"option","dateFormat"),i=new Date($(this).val());$(this).val()&&i&&$(this).val($.datepicker.formatDate(t,i))}),n(0,i,t.val()),r(t,i,"minDate"),r(i,t,"maxDate"),$([t.get(0),i.get(0)])},$.timepicker.version="1.1.1"}function Timepicker(){this.regional=[],this.regional[""]={currentText:"Now",closeText:"Done",amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"HH:mm",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",timezoneText:"Time Zone",isRTL:!1},this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:!0,showMinute:!0,showSecond:!1,showMillisec:!1,showTimezone:!1,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,hour:0,minute:0,second:0,millisec:0,timezone:null,useLocalTimezone:!1,defaultTimezone:"+0000",hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:!0,timezoneIso8601:!1,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null,controlType:"slider",defaultValue:null,parse:"strict"},$.extend(this._defaults,this.regional[""])}}(jQuery),function(){function e(e){return e&&e.__esModule?e.default:e}function t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function n(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function o(e,i){return!i||"object"!=((a=i)&&a.constructor===Symbol?"symbol":typeof a)&&"function"!=typeof i?t(e):i;var a}var c;function d(e){return Array.isArray(e)||"[object Object]"=={}.toString.call(e)}function u(e){return!e||"object"!=typeof e&&"function"!=typeof e}c=function e(){var t=[].slice.call(arguments),i=!1;"boolean"==typeof t[0]&&(i=t.shift());var a=t[0];if(u(a))throw new Error("extendee must be an object");for(var n=t.slice(1),r=n.length,s=0;s<r;s++){var l=n[s];for(var o in l)if(Object.prototype.hasOwnProperty.call(l,o)){var c=l[o];if(i&&d(c)){var h=Array.isArray(c)?[]:{};a[o]=e(!0,Object.prototype.hasOwnProperty.call(a,o)&&!u(a[o])?a[o]:h,c)}else a[o]=c}}return a};var h=function(){"use strict";function e(){i(this,e)}return n(e,[{key:"on",value:function(e,t){return this._callbacks=this._callbacks||{},this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t),this}},{key:"emit",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];this._callbacks=this._callbacks||{};var n=this._callbacks[e],r=!0,s=!1,l=void 0;if(n)try{for(var o,c=n[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){o.value.apply(this,i)}}catch(e){s=!0,l=e}finally{try{r||null==c.return||c.return()}finally{if(s)throw l}}return this.element&&this.element.dispatchEvent(this.makeEvent("dropzone:"+e,{args:i})),this}},{key:"makeEvent",value:function(e,t){var i={bubbles:!0,cancelable:!0,detail:t};if("function"==typeof window.CustomEvent)return new CustomEvent(e,i);var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,i.bubbles,i.cancelable,i.detail),a}},{key:"off",value:function(e,t){if(!this._callbacks||0===arguments.length)return this._callbacks={},this;var i=this._callbacks[e];if(!i)return this;if(1===arguments.length)return delete this._callbacks[e],this;for(var a=0;a<i.length;a++){if(i[a]===t){i.splice(a,1);break}}return this}}]),e}(),p={url:null,method:"post",withCredentials:!1,timeout:null,parallelUploads:2,uploadMultiple:!1,chunking:!1,forceChunking:!1,chunkSize:2097152,parallelChunkUploads:!1,retryChunks:!1,retryChunksLimit:3,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,thumbnailMethod:"crop",resizeWidth:null,resizeHeight:null,resizeMimeType:null,resizeQuality:.8,resizeMethod:"contain",filesizeBase:1e3,maxFiles:null,headers:null,defaultHeaders:!0,clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,disablePreviews:!1,hiddenInputContainer:"body",capture:null,renameFilename:null,renameFile:null,forceFallback:!1,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictUploadCanceled:"Upload canceled.",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",dictFileSizeUnits:{tb:"TB",gb:"GB",mb:"MB",kb:"KB",b:"b"},init:function(){},params:function(e,t,i){if(i)return{dzuuid:i.file.upload.uuid,dzchunkindex:i.index,dztotalfilesize:i.file.size,dzchunksize:this.options.chunkSize,dztotalchunkcount:i.file.upload.totalChunkCount,dzchunkbyteoffset:i.index*this.options.chunkSize}},accept:function(e,t){return t()},chunksUploaded:function(e,t){t()},binaryBody:!1,fallback:function(){var e;this.element.className="".concat(this.element.className," dz-browser-not-supported");var t=!0,i=!1,a=void 0;try{for(var n,r=this.element.getElementsByTagName("div")[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;if(/(^| )dz-message($| )/.test(s.className)){e=s,s.className="dz-message";break}}}catch(e){i=!0,a=e}finally{try{t||null==r.return||r.return()}finally{if(i)throw a}}e||(e=m.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(e));var l=e.getElementsByTagName("span")[0];return l&&(null!=l.textContent?l.textContent=this.options.dictFallbackMessage:null!=l.innerText&&(l.innerText=this.options.dictFallbackMessage)),this.element.appendChild(this.getFallbackForm())},resize:function(e,t,i,a){var n={srcX:0,srcY:0,srcWidth:e.width,srcHeight:e.height},r=e.width/e.height;null==t&&null==i?(t=n.srcWidth,i=n.srcHeight):null==t?t=i*r:null==i&&(i=t/r);var s=(t=Math.min(t,n.srcWidth))/(i=Math.min(i,n.srcHeight));if(n.srcWidth>t||n.srcHeight>i)if("crop"===a)r>s?(n.srcHeight=e.height,n.srcWidth=n.srcHeight*s):(n.srcWidth=e.width,n.srcHeight=n.srcWidth/s);else{if("contain"!==a)throw new Error("Unknown resizeMethod '".concat(a,"'"));r>s?i=t/r:t=i*r}return n.srcX=(e.width-n.srcWidth)/2,n.srcY=(e.height-n.srcHeight)/2,n.trgWidth=t,n.trgHeight=i,n},transformFile:function(e,t){return(this.options.resizeWidth||this.options.resizeHeight)&&e.type.match(/image.*/)?this.resizeImage(e,this.options.resizeWidth,this.options.resizeHeight,this.options.resizeMethod,t):t(e)},previewTemplate:e('<div class="dz-file-preview dz-preview"> <div class="dz-image"><img data-dz-thumbnail=""></div> <div class="dz-details"> <div class="dz-size"><span data-dz-size=""></span></div> <div class="dz-filename"><span data-dz-name=""></span></div> </div> <div class="dz-progress"> <span class="dz-upload" data-dz-uploadprogress=""></span> </div> <div class="dz-error-message"><span data-dz-errormessage=""></span></div> <div class="dz-success-mark"> <svg width="54" height="54" fill="#fff"><path d="m10.207 29.793 4.086-4.086a1 1 0 0 1 1.414 0l5.586 5.586a1 1 0 0 0 1.414 0l15.586-15.586a1 1 0 0 1 1.414 0l4.086 4.086a1 1 0 0 1 0 1.414L22.707 42.293a1 1 0 0 1-1.414 0L10.207 31.207a1 1 0 0 1 0-1.414Z"/></svg> </div> <div class="dz-error-mark"> <svg width="54" height="54" fill="#fff"><path d="m26.293 20.293-7.086-7.086a1 1 0 0 0-1.414 0l-4.586 4.586a1 1 0 0 0 0 1.414l7.086 7.086a1 1 0 0 1 0 1.414l-7.086 7.086a1 1 0 0 0 0 1.414l4.586 4.586a1 1 0 0 0 1.414 0l7.086-7.086a1 1 0 0 1 1.414 0l7.086 7.086a1 1 0 0 0 1.414 0l4.586-4.586a1 1 0 0 0 0-1.414l-7.086-7.086a1 1 0 0 1 0-1.414l7.086-7.086a1 1 0 0 0 0-1.414l-4.586-4.586a1 1 0 0 0-1.414 0l-7.086 7.086a1 1 0 0 1-1.414 0Z"/></svg> </div> </div>'),drop:function(e){return this.element.classList.remove("dz-drag-hover")},dragstart:function(e){},dragend:function(e){return this.element.classList.remove("dz-drag-hover")},dragenter:function(e){return this.element.classList.add("dz-drag-hover")},dragover:function(e){return this.element.classList.add("dz-drag-hover")},dragleave:function(e){return this.element.classList.remove("dz-drag-hover")},paste:function(e){},reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(e){if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer&&!this.options.disablePreviews){var t=this;e.previewElement=m.createElement(this.options.previewTemplate.trim()),e.previewTemplate=e.previewElement,this.previewsContainer.appendChild(e.previewElement);var i=!0,a=!1,n=void 0;try{for(var r,s=e.previewElement.querySelectorAll("[data-dz-name]")[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value;l.textContent=e.name}}catch(e){a=!0,n=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw n}}var o=!0,c=!1,d=void 0;try{for(var u,h=e.previewElement.querySelectorAll("[data-dz-size]")[Symbol.iterator]();!(o=(u=h.next()).done);o=!0)(l=u.value).innerHTML=this.filesize(e.size)}catch(e){c=!0,d=e}finally{try{o||null==h.return||h.return()}finally{if(c)throw d}}this.options.addRemoveLinks&&(e._removeLink=m.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'.concat(this.options.dictRemoveFile,"</a>")),e.previewElement.appendChild(e._removeLink));var p=function(i){var a=t;if(i.preventDefault(),i.stopPropagation(),e.status===m.UPLOADING)return m.confirm(t.options.dictCancelUploadConfirmation,function(){return a.removeFile(e)});var n=t;return t.options.dictRemoveFileConfirmation?m.confirm(t.options.dictRemoveFileConfirmation,function(){return n.removeFile(e)}):t.removeFile(e)},f=!0,v=!1,g=void 0;try{for(var _,k=e.previewElement.querySelectorAll("[data-dz-remove]")[Symbol.iterator]();!(f=(_=k.next()).done);f=!0)_.value.addEventListener("click",p)}catch(e){v=!0,g=e}finally{try{f||null==k.return||k.return()}finally{if(v)throw g}}}},removedfile:function(e){return null!=e.previewElement&&null!=e.previewElement.parentNode&&e.previewElement.parentNode.removeChild(e.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(e,t){if(e.previewElement){e.previewElement.classList.remove("dz-file-preview");var i=!0,a=!1,n=void 0;try{for(var r,s=e.previewElement.querySelectorAll("[data-dz-thumbnail]")[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value;l.alt=e.name,l.src=t}}catch(e){a=!0,n=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw n}}return setTimeout(function(){return e.previewElement.classList.add("dz-image-preview")},1)}},error:function(e,t){if(e.previewElement){e.previewElement.classList.add("dz-error"),"string"!=typeof t&&t.error&&(t=t.error);var i=!0,a=!1,n=void 0;try{for(var r,s=e.previewElement.querySelectorAll("[data-dz-errormessage]")[Symbol.iterator]();!(i=(r=s.next()).done);i=!0)r.value.textContent=t}catch(e){a=!0,n=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw n}}}},errormultiple:function(){},processing:function(e){if(e.previewElement&&(e.previewElement.classList.add("dz-processing"),e._removeLink))return e._removeLink.innerHTML=this.options.dictCancelUpload},processingmultiple:function(){},uploadprogress:function(e,t,i){var a=!0,n=!1,r=void 0;if(e.previewElement)try{for(var s,l=e.previewElement.querySelectorAll("[data-dz-uploadprogress]")[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var o=s.value;"PROGRESS"===o.nodeName?o.value=t:o.style.width="".concat(t,"%")}}catch(e){n=!0,r=e}finally{try{a||null==l.return||l.return()}finally{if(n)throw r}}},totaluploadprogress:function(){},sending:function(){},sendingmultiple:function(){},success:function(e){if(e.previewElement)return e.previewElement.classList.add("dz-success")},successmultiple:function(){},canceled:function(e){return this.emit("error",e,this.options.dictUploadCanceled)},canceledmultiple:function(){},complete:function(e){if(e._removeLink&&(e._removeLink.innerHTML=this.options.dictRemoveFile),e.previewElement)return e.previewElement.classList.add("dz-complete")},completemultiple:function(){},maxfilesexceeded:function(){},maxfilesreached:function(){},queuecomplete:function(){},addedfiles:function(){}},m=function(a){"use strict";function s(a,n){var l,d,u,h;if(i(this,s),(l=o(this,(d=s,r(d)).call(this))).element=a,l.clickableElements=[],l.listeners=[],l.files=[],"string"==typeof l.element&&(l.element=document.querySelector(l.element)),!l.element||null==l.element.nodeType)throw new Error("Invalid dropzone element.");if(l.element.dropzone)throw new Error("Dropzone already attached.");s.instances.push(t(l)),l.element.dropzone=t(l);var m=null!=(h=s.optionsForElement(l.element))?h:{};if(l.options=e(c)(!0,{},p,m,null!=n?n:{}),l.options.previewTemplate=l.options.previewTemplate.replace(/\n*/g,""),l.options.forceFallback||!s.isBrowserSupported())return o(l,l.options.fallback.call(t(l)));if(null==l.options.url&&(l.options.url=l.element.getAttribute("action")),!l.options.url)throw new Error("No URL provided.");if(l.options.acceptedFiles&&l.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");if(l.options.uploadMultiple&&l.options.chunking)throw new Error("You cannot set both: uploadMultiple and chunking.");if(l.options.binaryBody&&l.options.uploadMultiple)throw new Error("You cannot set both: binaryBody and uploadMultiple.");return l.options.acceptedMimeTypes&&(l.options.acceptedFiles=l.options.acceptedMimeTypes,delete l.options.acceptedMimeTypes),null!=l.options.renameFilename&&(l.options.renameFile=function(e){return l.options.renameFilename.call(t(l),e.name,e)}),"string"==typeof l.options.method&&(l.options.method=l.options.method.toUpperCase()),(u=l.getExistingFallback())&&u.parentNode&&u.parentNode.removeChild(u),!1!==l.options.previewsContainer&&(l.options.previewsContainer?l.previewsContainer=s.getElement(l.options.previewsContainer,"previewsContainer"):l.previewsContainer=l.element),l.options.clickable&&(!0===l.options.clickable?l.clickableElements=[l.element]:l.clickableElements=s.getElements(l.options.clickable,"clickable")),l.init(),l}return l(s,h),n(s,[{key:"getAcceptedFiles",value:function(){return this.files.filter(function(e){return e.accepted}).map(function(e){return e})}},{key:"getRejectedFiles",value:function(){return this.files.filter(function(e){return!e.accepted}).map(function(e){return e})}},{key:"getFilesWithStatus",value:function(e){return this.files.filter(function(t){return t.status===e}).map(function(e){return e})}},{key:"getQueuedFiles",value:function(){return this.getFilesWithStatus(s.QUEUED)}},{key:"getUploadingFiles",value:function(){return this.getFilesWithStatus(s.UPLOADING)}},{key:"getAddedFiles",value:function(){return this.getFilesWithStatus(s.ADDED)}},{key:"getActiveFiles",value:function(){return this.files.filter(function(e){return e.status===s.UPLOADING||e.status===s.QUEUED}).map(function(e){return e})}},{key:"init",value:function(){var e=this,t=this,i=this,a=this,n=this,r=this,l=this,o=this,c=this,d=this,u=this;if("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(s.createElement('<div class="dz-default dz-message"><button class="dz-button" type="button">'.concat(this.options.dictDefaultMessage,"</button></div>"))),this.clickableElements.length){var h=this,p=function(){var e=h;h.hiddenFileInput&&h.hiddenFileInput.parentNode.removeChild(h.hiddenFileInput),h.hiddenFileInput=document.createElement("input"),h.hiddenFileInput.setAttribute("type","file"),(null===h.options.maxFiles||h.options.maxFiles>1)&&h.hiddenFileInput.setAttribute("multiple","multiple"),h.hiddenFileInput.className="dz-hidden-input",null!==h.options.acceptedFiles&&h.hiddenFileInput.setAttribute("accept",h.options.acceptedFiles),null!==h.options.capture&&h.hiddenFileInput.setAttribute("capture",h.options.capture),h.hiddenFileInput.setAttribute("tabindex","-1"),h.hiddenFileInput.style.visibility="hidden",h.hiddenFileInput.style.position="absolute",h.hiddenFileInput.style.top="0",h.hiddenFileInput.style.left="0",h.hiddenFileInput.style.height="0",h.hiddenFileInput.style.width="0",s.getElement(h.options.hiddenInputContainer,"hiddenInputContainer").appendChild(h.hiddenFileInput),h.hiddenFileInput.addEventListener("change",function(){var t=e.hiddenFileInput.files,i=!0,a=!1,n=void 0;if(t.length)try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value;e.addFile(l)}}catch(e){a=!0,n=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw n}}e.emit("addedfiles",t),p()})};p()}this.URL=null!==window.URL?window.URL:window.webkitURL;var m=!0,f=!1,v=void 0;try{for(var g,_=this.events[Symbol.iterator]();!(m=(g=_.next()).done);m=!0){var k=g.value;this.on(k,this.options[k])}}catch(e){f=!0,v=e}finally{try{m||null==_.return||_.return()}finally{if(f)throw v}}this.on("uploadprogress",function(){return e.updateTotalUploadProgress()}),this.on("removedfile",function(){return t.updateTotalUploadProgress()}),this.on("canceled",function(e){return i.emit("complete",e)}),this.on("complete",function(e){var t=a;if(0===a.getAddedFiles().length&&0===a.getUploadingFiles().length&&0===a.getQueuedFiles().length)return setTimeout(function(){return t.emit("queuecomplete")},0)});var y=function(e){if(function(e){if(e.dataTransfer.types)for(var t=0;t<e.dataTransfer.types.length;t++)if("Files"===e.dataTransfer.types[t])return!0;return!1}(e))return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1};return this.listeners=[{element:this.element,events:{dragstart:function(e){return n.emit("dragstart",e)},dragenter:function(e){return y(e),r.emit("dragenter",e)},dragover:function(e){var t;try{t=e.dataTransfer.effectAllowed}catch(e){}return e.dataTransfer.dropEffect="move"===t||"linkMove"===t?"move":"copy",y(e),l.emit("dragover",e)},dragleave:function(e){return o.emit("dragleave",e)},drop:function(e){return y(e),c.drop(e)},dragend:function(e){return d.emit("dragend",e)}}}],this.clickableElements.forEach(function(e){var t=u;return u.listeners.push({element:e,events:{click:function(i){return(e!==t.element||i.target===t.element||s.elementInside(i.target,t.element.querySelector(".dz-message")))&&t.hiddenFileInput.click(),!0}}})}),this.enable(),this.options.init.call(this)}},{key:"destroy",value:function(){return this.disable(),this.removeAllFiles(!0),(null!=this.hiddenFileInput?this.hiddenFileInput.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,s.instances.splice(s.instances.indexOf(this),1)}},{key:"updateTotalUploadProgress",value:function(){var e,t=0,i=0;if(this.getActiveFiles().length){var a=!0,n=!1,r=void 0;try{for(var s,l=this.getActiveFiles()[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var o=s.value;t+=o.upload.bytesSent,i+=o.upload.total}}catch(e){n=!0,r=e}finally{try{a||null==l.return||l.return()}finally{if(n)throw r}}e=100*t/i}else e=100;return this.emit("totaluploadprogress",e,i,t)}},{key:"_getParamName",value:function(e){return"function"==typeof this.options.paramName?this.options.paramName(e):"".concat(this.options.paramName).concat(this.options.uploadMultiple?"[".concat(e,"]"):"")}},{key:"_renameFile",value:function(e){return"function"!=typeof this.options.renameFile?e.name:this.options.renameFile(e)}},{key:"getFallbackForm",value:function(){var e,t;if(e=this.getExistingFallback())return e;var i='<div class="dz-fallback">';this.options.dictFallbackText&&(i+="<p>".concat(this.options.dictFallbackText,"</p>")),i+='<input type="file" name="'.concat(this._getParamName(0),'" ').concat(this.options.uploadMultiple?'multiple="multiple"':void 0,' /><input type="submit" value="Upload!"></div>');var a=s.createElement(i);return"FORM"!==this.element.tagName?(t=s.createElement('<form action="'.concat(this.options.url,'" enctype="multipart/form-data" method="').concat(this.options.method,'"></form>'))).appendChild(a):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=t?t:a}},{key:"getExistingFallback",value:function(){var e=function(e){var t=!0,i=!1,a=void 0;try{for(var n,r=e[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;if(/(^| )fallback($| )/.test(s.className))return s}}catch(e){i=!0,a=e}finally{try{t||null==r.return||r.return()}finally{if(i)throw a}}},t=!0,i=!1,a=void 0;try{for(var n,r=["div","form"][Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s,l=n.value;if(s=e(this.element.getElementsByTagName(l)))return s}}catch(e){i=!0,a=e}finally{try{t||null==r.return||r.return()}finally{if(i)throw a}}}},{key:"setupEventListeners",value:function(){return this.listeners.map(function(e){return function(){var t=[];for(var i in e.events){var a=e.events[i];t.push(e.element.addEventListener(i,a,!1))}return t}()})}},{key:"removeEventListeners",value:function(){return this.listeners.map(function(e){return function(){var t=[];for(var i in e.events){var a=e.events[i];t.push(e.element.removeEventListener(i,a,!1))}return t}()})}},{key:"disable",value:function(){var e=this;return this.clickableElements.forEach(function(e){return e.classList.remove("dz-clickable")}),this.removeEventListeners(),this.disabled=!0,this.files.map(function(t){return e.cancelUpload(t)})}},{key:"enable",value:function(){return delete this.disabled,this.clickableElements.forEach(function(e){return e.classList.add("dz-clickable")}),this.setupEventListeners()}},{key:"filesize",value:function(e){var t=0,i="b";if(e>0){for(var a=["tb","gb","mb","kb","b"],n=0;n<a.length;n++){var r=a[n];if(e>=Math.pow(this.options.filesizeBase,4-n)/10){t=e/Math.pow(this.options.filesizeBase,4-n),i=r;break}}t=Math.round(10*t)/10}return"<strong>".concat(t,"</strong> ").concat(this.options.dictFileSizeUnits[i])}},{key:"_updateMaxFilesReachedClass",value:function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")}},{key:"drop",value:function(e){if(e.dataTransfer){this.emit("drop",e);for(var t=[],i=0;i<e.dataTransfer.files.length;i++)t[i]=e.dataTransfer.files[i];if(t.length){var a=e.dataTransfer.items;a&&a.length&&null!=a[0].webkitGetAsEntry?this._addFilesFromItems(a):this.handleFiles(t)}this.emit("addedfiles",t)}}},{key:"paste",value:function(e){if(null!=(null!=(t=null!=e?e.clipboardData:void 0)?function(e){return e.items}(t):void 0)){var t;this.emit("paste",e);var i=e.clipboardData.items;return i.length?this._addFilesFromItems(i):void 0}}},{key:"handleFiles",value:function(e){var t=!0,i=!1,a=void 0;try{for(var n,r=e[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;this.addFile(s)}}catch(e){i=!0,a=e}finally{try{t||null==r.return||r.return()}finally{if(i)throw a}}}},{key:"_addFilesFromItems",value:function(e){var t=this;return function(){var i=[],a=!0,n=!1,r=void 0;try{for(var s,l=e[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var o,c=s.value;null!=c.webkitGetAsEntry&&(o=c.webkitGetAsEntry())?o.isFile?i.push(t.addFile(c.getAsFile())):o.isDirectory?i.push(t._addFilesFromDirectory(o,o.name)):i.push(void 0):null==c.getAsFile||null!=c.kind&&"file"!==c.kind?i.push(void 0):i.push(t.addFile(c.getAsFile()))}}catch(e){n=!0,r=e}finally{try{a||null==l.return||l.return()}finally{if(n)throw r}}return i}()}},{key:"_addFilesFromDirectory",value:function(e,t){var i=this,a=e.createReader(),n=function(e){return"log",i=function(t){return t.log(e)},null!=(t=console)&&"function"==typeof t.log?i(t):void 0;var t,i},r=function(){var e=i;return a.readEntries(function(i){if(i.length>0){var a=!0,n=!1,s=void 0;try{for(var l,o=i[Symbol.iterator]();!(a=(l=o.next()).done);a=!0){var c=l.value,d=e;c.isFile?c.file(function(e){if(!d.options.ignoreHiddenFiles||"."!==e.name.substring(0,1))return e.fullPath="".concat(t,"/").concat(e.name),d.addFile(e)}):c.isDirectory&&e._addFilesFromDirectory(c,"".concat(t,"/").concat(c.name))}}catch(e){n=!0,s=e}finally{try{a||null==o.return||o.return()}finally{if(n)throw s}}r()}return null},n)};return r()}},{key:"accept",value:function(e,t){this.options.maxFilesize&&e.size>1048576*this.options.maxFilesize?t(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(e.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):s.isValidFile(e,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(t(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",e)):this.options.accept.call(this,e,t):t(this.options.dictInvalidFileType)}},{key:"addFile",value:function(e){var t=this;e.upload={uuid:s.uuidv4(),progress:0,total:e.size,bytesSent:0,filename:this._renameFile(e)},this.files.push(e),e.status=s.ADDED,this.emit("addedfile",e),this._enqueueThumbnail(e),this.accept(e,function(i){i?(e.accepted=!1,t._errorProcessing([e],i)):(e.accepted=!0,t.options.autoQueue&&t.enqueueFile(e)),t._updateMaxFilesReachedClass()})}},{key:"enqueueFiles",value:function(e){var t=!0,i=!1,a=void 0;try{for(var n,r=e[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;this.enqueueFile(s)}}catch(e){i=!0,a=e}finally{try{t||null==r.return||r.return()}finally{if(i)throw a}}return null}},{key:"enqueueFile",value:function(e){if(e.status!==s.ADDED||!0!==e.accepted)throw new Error("This file can't be queued because it has already been processed or was rejected.");var t=this;if(e.status=s.QUEUED,this.options.autoProcessQueue)return setTimeout(function(){return t.processQueue()},0)}},{key:"_enqueueThumbnail",value:function(e){if(this.options.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=1048576*this.options.maxThumbnailFilesize){var t=this;return this._thumbnailQueue.push(e),setTimeout(function(){return t._processThumbnailQueue()},0)}}},{key:"_processThumbnailQueue",value:function(){var e=this;if(!this._processingThumbnail&&0!==this._thumbnailQueue.length){this._processingThumbnail=!0;var t=this._thumbnailQueue.shift();return this.createThumbnail(t,this.options.thumbnailWidth,this.options.thumbnailHeight,this.options.thumbnailMethod,!0,function(i){return e.emit("thumbnail",t,i),e._processingThumbnail=!1,e._processThumbnailQueue()})}}},{key:"removeFile",value:function(e){if(e.status===s.UPLOADING&&this.cancelUpload(e),this.files=f(this.files,e),this.emit("removedfile",e),0===this.files.length)return this.emit("reset")}},{key:"removeAllFiles",value:function(e){null==e&&(e=!1);var t=!0,i=!1,a=void 0;try{for(var n,r=this.files.slice()[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var l=n.value;(l.status!==s.UPLOADING||e)&&this.removeFile(l)}}catch(e){i=!0,a=e}finally{try{t||null==r.return||r.return()}finally{if(i)throw a}}return null}},{key:"resizeImage",value:function(e,t,i,a,n){var r=this;return this.createThumbnail(e,t,i,a,!0,function(t,i){if(null==i)return n(e);var a=r.options.resizeMimeType;null==a&&(a=e.type);var l=i.toDataURL(a,r.options.resizeQuality);return"image/jpeg"!==a&&"image/jpg"!==a||(l=_.restore(e.dataURL,l)),n(s.dataURItoBlob(l))})}},{key:"createThumbnail",value:function(e,t,i,a,n,r){var s=this,l=new FileReader;l.onload=function(){e.dataURL=l.result,"image/svg+xml"!==e.type?s.createThumbnailFromUrl(e,t,i,a,n,r):null!=r&&r(l.result)},l.readAsDataURL(e)}},{key:"displayExistingFile",value:function(e,t,i,a,n){var r=void 0===n||n;if(this.emit("addedfile",e),this.emit("complete",e),r){var s=this;e.dataURL=t,this.createThumbnailFromUrl(e,this.options.thumbnailWidth,this.options.thumbnailHeight,this.options.thumbnailMethod,this.options.fixOrientation,function(t){s.emit("thumbnail",e,t),i&&i()},a)}else this.emit("thumbnail",e,t),i&&i()}},{key:"createThumbnailFromUrl",value:function(e,t,i,a,n,r,s){var l=this,o=document.createElement("img");return s&&(o.crossOrigin=s),n="from-image"!=getComputedStyle(document.body).imageOrientation&&n,o.onload=function(){var s=l,c=function(e){return e(1)};return"undefined"!=typeof EXIF&&null!==EXIF&&n&&(c=function(e){return EXIF.getData(o,function(){return e(EXIF.getTag(this,"Orientation"))})}),c(function(n){e.width=o.width,e.height=o.height;var l=s.options.resize.call(s,e,t,i,a),c=document.createElement("canvas"),d=c.getContext("2d");switch(c.width=l.trgWidth,c.height=l.trgHeight,n>4&&(c.width=l.trgHeight,c.height=l.trgWidth),n){case 2:d.translate(c.width,0),d.scale(-1,1);break;case 3:d.translate(c.width,c.height),d.rotate(Math.PI);break;case 4:d.translate(0,c.height),d.scale(1,-1);break;case 5:d.rotate(.5*Math.PI),d.scale(1,-1);break;case 6:d.rotate(.5*Math.PI),d.translate(0,-c.width);break;case 7:d.rotate(.5*Math.PI),d.translate(c.height,-c.width),d.scale(-1,1);break;case 8:d.rotate(-.5*Math.PI),d.translate(-c.height,0)}g(d,o,null!=l.srcX?l.srcX:0,null!=l.srcY?l.srcY:0,l.srcWidth,l.srcHeight,null!=l.trgX?l.trgX:0,null!=l.trgY?l.trgY:0,l.trgWidth,l.trgHeight);var u=c.toDataURL("image/png");if(null!=r)return r(u,c)})},null!=r&&(o.onerror=r),o.src=e.dataURL}},{key:"processQueue",value:function(){var e=this.options.parallelUploads,t=this.getUploadingFiles().length,i=t;if(!(t>=e)){var a=this.getQueuedFiles();if(a.length>0){if(this.options.uploadMultiple)return this.processFiles(a.slice(0,e-t));for(;i<e;){if(!a.length)return;this.processFile(a.shift()),i++}}}}},{key:"processFile",value:function(e){return this.processFiles([e])}},{key:"processFiles",value:function(e){var t=!0,i=!1,a=void 0;try{for(var n,r=e[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var l=n.value;l.processing=!0,l.status=s.UPLOADING,this.emit("processing",l)}}catch(e){i=!0,a=e}finally{try{t||null==r.return||r.return()}finally{if(i)throw a}}return this.options.uploadMultiple&&this.emit("processingmultiple",e),this.uploadFiles(e)}},{key:"_getFilesWithXhr",value:function(e){return this.files.filter(function(t){return t.xhr===e}).map(function(e){return e})}},{key:"cancelUpload",value:function(e){if(e.status===s.UPLOADING){var t=this._getFilesWithXhr(e.xhr),i=!0,a=!1,n=void 0;try{for(var r,l=t[Symbol.iterator]();!(i=(r=l.next()).done);i=!0)(p=r.value).status=s.CANCELED}catch(e){a=!0,n=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw n}}void 0!==e.xhr&&e.xhr.abort();var o=!0,c=!1,d=void 0;try{for(var u,h=t[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){var p=u.value;this.emit("canceled",p)}}catch(e){c=!0,d=e}finally{try{o||null==h.return||h.return()}finally{if(c)throw d}}this.options.uploadMultiple&&this.emit("canceledmultiple",t)}else e.status!==s.ADDED&&e.status!==s.QUEUED||(e.status=s.CANCELED,this.emit("canceled",e),this.options.uploadMultiple&&this.emit("canceledmultiple",[e]));if(this.options.autoProcessQueue)return this.processQueue()}},{key:"resolveOption",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];return"function"==typeof e?e.apply(this,i):e}},{key:"uploadFile",value:function(e){return this.uploadFiles([e])}},{key:"uploadFiles",value:function(e){var t=this;this._transformFiles(e,function(i){if(t.options.chunking){var a=i[0];e[0].upload.chunked=t.options.chunking&&(t.options.forceChunking||a.size>t.options.chunkSize),e[0].upload.totalChunkCount=Math.ceil(a.size/t.options.chunkSize)}if(e[0].upload.chunked){var n=t,r=t,l=e[0];a=i[0];l.upload.chunks=[];var o=function(){for(var t=0;void 0!==l.upload.chunks[t];)t++;if(!(t>=l.upload.totalChunkCount)){var i=t*n.options.chunkSize,r=Math.min(i+n.options.chunkSize,a.size),o={name:n._getParamName(0),data:a.webkitSlice?a.webkitSlice(i,r):a.slice(i,r),filename:l.upload.filename,chunkIndex:t};l.upload.chunks[t]={file:l,index:t,dataBlock:o,status:s.UPLOADING,progress:0,retries:0},n._uploadData(e,[o])}};if(l.upload.finishedChunkUpload=function(t,i){var a=r,n=!0;t.status=s.SUCCESS,t.dataBlock=null,t.response=t.xhr.responseText,t.responseHeaders=t.xhr.getAllResponseHeaders(),t.xhr=null;for(var c=0;c<l.upload.totalChunkCount;c++){if(void 0===l.upload.chunks[c])return o();l.upload.chunks[c].status!==s.SUCCESS&&(n=!1)}n&&r.options.chunksUploaded(l,function(){a._finished(e,i,null)})},t.options.parallelChunkUploads)for(var c=0;c<l.upload.totalChunkCount;c++)o();else o()}else{var d=[];for(c=0;c<e.length;c++)d[c]={name:t._getParamName(c),data:i[c],filename:e[c].upload.filename};t._uploadData(e,d)}})}},{key:"_getChunk",value:function(e,t){for(var i=0;i<e.upload.totalChunkCount;i++)if(void 0!==e.upload.chunks[i]&&e.upload.chunks[i].xhr===t)return e.upload.chunks[i]}},{key:"_uploadData",value:function(t,i){var a=this,n=this,r=this,s=this,l=new XMLHttpRequest,o=!0,d=!1,u=void 0;try{for(var h=t[Symbol.iterator]();!(o=(T=h.next()).done);o=!0)(_=T.value).xhr=l}catch(e){d=!0,u=e}finally{try{o||null==h.return||h.return()}finally{if(d)throw u}}t[0].upload.chunked&&(t[0].upload.chunks[i[0].chunkIndex].xhr=l);var p=this.resolveOption(this.options.method,t,i),m=this.resolveOption(this.options.url,t,i);l.open(p,m,!0),this.resolveOption(this.options.timeout,t)&&(l.timeout=this.resolveOption(this.options.timeout,t)),l.withCredentials=!!this.options.withCredentials,l.onload=function(e){a._finishedUploading(t,l,e)},l.ontimeout=function(){n._handleUploadError(t,l,"Request timedout after ".concat(n.options.timeout/1e3," seconds"))},l.onerror=function(){r._handleUploadError(t,l)},(null!=l.upload?l.upload:l).onprogress=function(e){return s._updateFilesUploadProgress(t,l,e)};var f=this.options.defaultHeaders?{Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"}:{};for(var v in this.options.binaryBody&&(f["Content-Type"]=t[0].type),this.options.headers&&e(c)(f,this.options.headers),f){var g=f[v];g&&l.setRequestHeader(v,g)}if(this.options.binaryBody){o=!0,d=!1,u=void 0;try{for(h=t[Symbol.iterator]();!(o=(T=h.next()).done);o=!0){var _=T.value;this.emit("sending",_,l)}}catch(e){d=!0,u=e}finally{try{o||null==h.return||h.return()}finally{if(d)throw u}}this.options.uploadMultiple&&this.emit("sendingmultiple",t,l),this.submitRequest(l,null,t)}else{var k=new FormData;if(this.options.params){var y=this.options.params;for(var b in"function"==typeof y&&(y=y.call(this,t,l,t[0].upload.chunked?this._getChunk(t[0],l):null)),y){var x=y[b];if(Array.isArray(x))for(var w=0;w<x.length;w++)k.append(b,x[w]);else k.append(b,x)}}o=!0,d=!1,u=void 0;try{var T;for(h=t[Symbol.iterator]();!(o=(T=h.next()).done);o=!0)_=T.value,this.emit("sending",_,l,k)}catch(e){d=!0,u=e}finally{try{o||null==h.return||h.return()}finally{if(d)throw u}}this.options.uploadMultiple&&this.emit("sendingmultiple",t,l,k),this._addFormElementData(k);for(w=0;w<i.length;w++){var M=i[w];k.append(M.name,M.data,M.filename)}this.submitRequest(l,k,t)}}},{key:"_transformFiles",value:function(e,t){for(var i=this,a=function(a){i.options.transformFile.call(i,e[a],function(i){n[a]=i,++r===e.length&&t(n)})},n=[],r=0,s=0;s<e.length;s++)a(s)}},{key:"_addFormElementData",value:function(e){var t,i=!0,a=!1,n=void 0;if("FORM"===this.element.tagName)try{for(t=this.element.querySelectorAll("input, textarea, select, button")[Symbol.iterator]();!(i=(o=t.next()).done);i=!0){var r=o.value,s=r.getAttribute("name"),l=r.getAttribute("type");if(l&&(l=l.toLowerCase()),null!=s)if("SELECT"===r.tagName&&r.hasAttribute("multiple")){i=!0,a=!1,n=void 0;try{var o;for(t=r.options[Symbol.iterator]();!(i=(o=t.next()).done);i=!0){var c=o.value;c.selected&&e.append(s,c.value)}}catch(e){a=!0,n=e}finally{try{i||null==t.return||t.return()}finally{if(a)throw n}}}else(!l||"checkbox"!==l&&"radio"!==l||r.checked)&&e.append(s,r.value)}}catch(e){a=!0,n=e}finally{try{i||null==t.return||t.return()}finally{if(a)throw n}}}},{key:"_updateFilesUploadProgress",value:function(e,t,i){var a=!0,n=!1,r=void 0;if(e[0].upload.chunked){d=e[0];var s=this._getChunk(d,t);i?(s.progress=100*i.loaded/i.total,s.total=i.total,s.bytesSent=i.loaded):(s.progress=100,s.bytesSent=s.total),d.upload.progress=0,d.upload.total=0,d.upload.bytesSent=0;for(var l=0;l<d.upload.totalChunkCount;l++)d.upload.chunks[l]&&void 0!==d.upload.chunks[l].progress&&(d.upload.progress+=d.upload.chunks[l].progress,d.upload.total+=d.upload.chunks[l].total,d.upload.bytesSent+=d.upload.chunks[l].bytesSent);d.upload.progress=d.upload.progress/d.upload.totalChunkCount,this.emit("uploadprogress",d,d.upload.progress,d.upload.bytesSent)}else try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var d;(d=o.value).upload.total&&d.upload.bytesSent&&d.upload.bytesSent==d.upload.total||(i?(d.upload.progress=100*i.loaded/i.total,d.upload.total=i.total,d.upload.bytesSent=i.loaded):(d.upload.progress=100,d.upload.bytesSent=d.upload.total),this.emit("uploadprogress",d,d.upload.progress,d.upload.bytesSent))}}catch(e){n=!0,r=e}finally{try{a||null==c.return||c.return()}finally{if(n)throw r}}}},{key:"_finishedUploading",value:function(e,t,i){var a;if(e[0].status!==s.CANCELED&&4===t.readyState){if("arraybuffer"!==t.responseType&&"blob"!==t.responseType&&(a=t.responseText,t.getResponseHeader("content-type")&&~t.getResponseHeader("content-type").indexOf("application/json")))try{a=JSON.parse(a)}catch(e){i=e,a="Invalid JSON response from server."}this._updateFilesUploadProgress(e,t),200<=t.status&&t.status<300?e[0].upload.chunked?e[0].upload.finishedChunkUpload(this._getChunk(e[0],t),a):this._finished(e,a,i):this._handleUploadError(e,t,a)}}},{key:"_handleUploadError",value:function(e,t,i){if(e[0].status!==s.CANCELED){if(e[0].upload.chunked&&this.options.retryChunks){var a=this._getChunk(e[0],t);if(a.retries++<this.options.retryChunksLimit)return void this._uploadData(e,[a.dataBlock]);console.warn("Retried this chunk too often. Giving up.")}this._errorProcessing(e,i||this.options.dictResponseError.replace("{{statusCode}}",t.status),t)}}},{key:"submitRequest",value:function(e,t,i){if(1==e.readyState)if(this.options.binaryBody)if(i[0].upload.chunked){var a=this._getChunk(i[0],e);e.send(a.dataBlock.data)}else e.send(i[0]);else e.send(t);else console.warn("Cannot send this request because the XMLHttpRequest.readyState is not OPENED.")}},{key:"_finished",value:function(e,t,i){var a=!0,n=!1,r=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done);a=!0){var c=l.value;c.status=s.SUCCESS,this.emit("success",c,t,i),this.emit("complete",c)}}catch(e){n=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}if(this.options.uploadMultiple&&(this.emit("successmultiple",e,t,i),this.emit("completemultiple",e)),this.options.autoProcessQueue)return this.processQueue()}},{key:"_errorProcessing",value:function(e,t,i){var a=!0,n=!1,r=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done);a=!0){var c=l.value;c.status=s.ERROR,this.emit("error",c,t,i),this.emit("complete",c)}}catch(e){n=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}if(this.options.uploadMultiple&&(this.emit("errormultiple",e,t,i),this.emit("completemultiple",e)),this.options.autoProcessQueue)return this.processQueue()}}],[{key:"initClass",value:function(){this.prototype.Emitter=h,this.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","addedfiles","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],this.prototype._thumbnailQueue=[],this.prototype._processingThumbnail=!1}},{key:"uuidv4",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}}]),s}();m.initClass(),m.options={},m.optionsForElement=function(e){return e.getAttribute("id")?m.options[v(e.getAttribute("id"))]:void 0},m.instances=[],m.forElement=function(e){if("string"==typeof e&&(e=document.querySelector(e)),null==(null!=e?e.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return e.dropzone},m.discover=function(){var e;if(document.querySelectorAll)e=document.querySelectorAll(".dropzone");else{e=[];var t=function(t){return function(){var i=[],a=!0,n=!1,r=void 0;try{for(var s,l=t[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var o=s.value;/(^| )dropzone($| )/.test(o.className)?i.push(e.push(o)):i.push(void 0)}}catch(e){n=!0,r=e}finally{try{a||null==l.return||l.return()}finally{if(n)throw r}}return i}()};t(document.getElementsByTagName("div")),t(document.getElementsByTagName("form"))}return function(){var t=[],i=!0,a=!1,n=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value;!1!==m.optionsForElement(l)?t.push(new m(l)):t.push(void 0)}}catch(e){a=!0,n=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw n}}return t}()},m.blockedBrowsers=[/opera.*(Macintosh|Windows Phone).*version\/12/i],m.isBrowserSupported=function(){var e=!0;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a")){void 0!==m.blacklistedBrowsers&&(m.blockedBrowsers=m.blacklistedBrowsers);var t=!0,i=!1,a=void 0;try{for(var n,r=m.blockedBrowsers[Symbol.iterator]();!(t=(n=r.next()).done);t=!0)n.value.test(navigator.userAgent)&&(e=!1)}catch(e){i=!0,a=e}finally{try{t||null==r.return||r.return()}finally{if(i)throw a}}}else e=!1;else e=!1;return e},m.dataURItoBlob=function(e){for(var t=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(t.length),n=new Uint8Array(a),r=0,s=t.length,l=0<=s;l?r<=s:r>=s;l?r++:r--)n[r]=t.charCodeAt(r);return new Blob([a],{type:i})};var f=function(e,t){return e.filter(function(e){return e!==t}).map(function(e){return e})},v=function(e){return e.replace(/[\-_](\w)/g,function(e){return e.charAt(1).toUpperCase()})};m.createElement=function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0]},m.elementInside=function(e,t){if(e===t)return!0;for(;e=e.parentNode;)if(e===t)return!0;return!1},m.getElement=function(e,t){var i;if("string"==typeof e?i=document.querySelector(e):null!=e.nodeType&&(i=e),null==i)throw new Error("Invalid `".concat(t,"` option provided. Please provide a CSS selector or a plain HTML element."));return i},m.getElements=function(e,t){var i,a;if(e instanceof Array){a=[];try{var n=!0,r=!1,s=void 0;try{for(var l=e[Symbol.iterator]();!(n=(o=l.next()).done);n=!0)i=o.value,a.push(this.getElement(i,t))}catch(e){r=!0,s=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}}catch(e){a=null}}else if("string"==typeof e){a=[],n=!0,r=!1,s=void 0;try{var o;for(l=document.querySelectorAll(e)[Symbol.iterator]();!(n=(o=l.next()).done);n=!0)i=o.value,a.push(i)}catch(e){r=!0,s=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}}else null!=e.nodeType&&(a=[e]);if(null==a||!a.length)throw new Error("Invalid `".concat(t,"` option provided. Please provide a CSS selector, a plain HTML element or a list of those."));return a},m.confirm=function(e,t,i){return window.confirm(e)?t():null!=i?i():void 0},m.isValidFile=function(e,t){if(!t)return!0;t=t.split(",");var i=e.type,a=i.replace(/\/.*$/,""),n=!0,r=!1,s=void 0;try{for(var l,o=t[Symbol.iterator]();!(n=(l=o.next()).done);n=!0){var c=l.value;if("."===(c=c.trim()).charAt(0)){if(-1!==e.name.toLowerCase().indexOf(c.toLowerCase(),e.name.length-c.length))return!0}else if(/\/\*$/.test(c)){if(a===c.replace(/\/.*$/,""))return!0}else if(i===c)return!0}}catch(e){r=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(e){return this.each(function(){return new m(this,e)})}),m.ADDED="added",m.QUEUED="queued",m.ACCEPTED=m.QUEUED,m.UPLOADING="uploading",m.PROCESSING=m.UPLOADING,m.CANCELED="canceled",m.ERROR="error",m.SUCCESS="success";var g=function(e,t,i,a,n,r,s,l,o,c){var d=function(e){e.naturalWidth;var t=e.naturalHeight,i=document.createElement("canvas");i.width=1,i.height=t;var a=i.getContext("2d");a.drawImage(e,0,0);for(var n=a.getImageData(1,0,1,t).data,r=0,s=t,l=t;l>r;)0===n[4*(l-1)+3]?s=l:r=l,l=s+r>>1;var o=l/t;return 0===o?1:o}(t);return e.drawImage(t,i,a,n,r,s,l,o,c/d)},_=function(){"use strict";function e(){i(this,e)}return n(e,null,[{key:"initClass",value:function(){this.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}},{key:"encode64",value:function(e){for(var t="",i=void 0,a=void 0,n="",r=void 0,s=void 0,l=void 0,o="",c=0;r=(i=e[c++])>>2,s=(3&i)<<4|(a=e[c++])>>4,l=(15&a)<<2|(n=e[c++])>>6,o=63&n,isNaN(a)?l=o=64:isNaN(n)&&(o=64),t=t+this.KEY_STR.charAt(r)+this.KEY_STR.charAt(s)+this.KEY_STR.charAt(l)+this.KEY_STR.charAt(o),i=a=n="",r=s=l=o="",c<e.length;);return t}},{key:"restore",value:function(e,t){if(!e.match("data:image/jpeg;base64,"))return t;var i=this.decode64(e.replace("data:image/jpeg;base64,","")),a=this.slice2Segments(i),n=this.exifManipulation(t,a);return"data:image/jpeg;base64,".concat(this.encode64(n))}},{key:"exifManipulation",value:function(e,t){var i=this.getExifArray(t),a=this.insertExif(e,i);return new Uint8Array(a)}},{key:"getExifArray",value:function(e){for(var t=void 0,i=0;i<e.length;){if(255===(t=e[i])[0]&225===t[1])return t;i++}return[]}},{key:"insertExif",value:function(e,t){var i=e.replace("data:image/jpeg;base64,",""),a=this.decode64(i),n=a.indexOf(255,3),r=a.slice(0,n),s=a.slice(n),l=r;return(l=l.concat(t)).concat(s)}},{key:"slice2Segments",value:function(e){for(var t=0,i=[];!(255===e[t]&218===e[t+1]);){if(255===e[t]&216===e[t+1])t+=2;else{var a=t+(256*e[t+2]+e[t+3])+2,n=e.slice(t,a);i.push(n),t=a}if(t>e.length)break}return i}},{key:"decode64",value:function(e){var t=void 0,i=void 0,a="",n=void 0,r=void 0,s="",l=0,o=[];for(/[^A-Za-z0-9\+\/\=]/g.exec(e)&&console.warn("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");t=this.KEY_STR.indexOf(e.charAt(l++))<<2|(n=this.KEY_STR.indexOf(e.charAt(l++)))>>4,i=(15&n)<<4|(r=this.KEY_STR.indexOf(e.charAt(l++)))>>2,a=(3&r)<<6|(s=this.KEY_STR.indexOf(e.charAt(l++))),o.push(t),64!==r&&o.push(i),64!==s&&o.push(a),t=i=a="",n=r=s="",l<e.length;);return o}}]),e}();_.initClass(),window.Dropzone=m}(),$(function(){function e(e){if(e.data("max-blocks")){var t=e.data("max-blocks");e.children(".repeater-wrapper").length>=t?e.find(".ecb2-repeater-add").prop("disabled",!0):e.find(".ecb2-repeater-add").prop("disabled",!1)}}function t(e){e.find(".sub-field-heading").each(function(){var t=$(this).data("heading-for"),i=e.find(".sub-field"+t).first().outerWidth();e.find(t+":not(.row1)").outerWidth(i)})}function i(e,t,i){e.find(".repeater-field").each(function(){var e=$(this).data("field-name");e?$(this).attr("name",t+"[r_"+i+"]["+e+"]").attr("id",t+"_r_"+i+"_"+e):$(this).attr("name",t+"[r_"+i+"]").attr("id",t+"_r_"+i),$(this).hasClass("cms_checkbox")&&$(this).siblings("label").attr("for",$(this).attr("id")),$(this).hasClass("colorpicker-template")&&($(this).removeClass("colorpicker-template").addClass("colorpicker"),c($(this))),$(this).hasClass("datetimepicker-template")&&($(this).removeClass("datetimepicker-template").addClass("datetimepicker"),o($(this))),$(this).hasClass("datepicker-template")&&($(this).removeClass("datepicker-template").addClass("datepicker"),l($(this))),$(this).hasClass("timepicker-template")&&($(this).removeClass("timepicker-template").addClass("timepicker"),s($(this))),$(this).hasClass("timepicker-template")&&($(this).removeClass("timepicker-template").addClass("timepicker"),s($(this))),$(this).parent(".sub-field-page_picker").length&&$(this).hierselector({value:-1,allowcurrent:!1,allow_all:!1,use_perms:!1,for_child:!1,is_manager:1})})}function a(e){e.find(".repeater-field").each(function(){$(this).hasClass("wysiwyg")&&(editor=tinymce.get($(this).attr("id")),null!=editor&&(editor.save(),editor.remove()))})}function n(e){var t=e.children("li:not(.placeholder)"),i=$("#"+e.data("cmsms-cb-input")),a="",n=e.data("required-number");n&&t.length!=n?i.val(""):(t.each(function(){a=""==a?$(this).data("cmsms-item-id"):a+","+$(this).data("cmsms-item-id")}),i.val(a))}function r(e){var t=e.data("required-number"),i=e.children().length-1;!t&&i>0||t>0&&i==t?e.children(".placeholder").addClass("hidden"):e.children(".placeholder").removeClass("hidden")}function s(e){e.timepicker({timeFormat:$(this).data("time-format")})}function l(e){e.datepicker({showOtherMonths:!0,selectOtherMonths:!0,dateFormat:$(this).data("date-format"),changeMonth:$(this).data("change-month"),changeYear:$(this).data("change-year"),yearRange:$(this).data("year-range")})}function o(e){e.datetimepicker({showOtherMonths:!0,selectOtherMonths:!0,dateFormat:$(this).data("date-format"),timeFormat:$(this).data("time-format"),changeMonth:$(this).data("change-month"),changeYear:$(this).data("change-year"),yearRange:$(this).data("year-range")})}function c(e){e.colpick({colorScheme:"dark",submit:!1,onChange:function(e,t,i,a){var n=$(a).data("no-hash")?"":"#";$(a).val(n+t).css("border-right","30px solid #"+t)},onBeforeShow:function(){""==this.value?$(this).css("border-right","30px solid transparent"):$(this).colpickSetColor(this.value)}}).on("keyup",function(){""==this.value?$(this).css("border-right","30px solid transparent"):$(this).colpickSetColor(this.value)}).each(function(){""==this.value?$(this).css("border-right","30px solid transparent"):$(this).css("border-right","30px solid #"+this.value.replaceAll("#",""))})}function d(e){var t=$(e.element),i=t.data("dropzone-max-files"),a=t.children(".dz-preview").length,n=t.children(".dz-upload-prompt"),r=Math.max(0,i-a);i>0&&(e.options.maxFiles=r),0==a?n.show():a>0&&n.remove().insertAfter(t.children(".dz-preview:last")).show(),i>0&&a>=i&&n.hide()}$("a.smooth-scroll").on("click",function(e){if(""!==this.hash){e.preventDefault();var t=this.hash;$("html, body").animate({scrollTop:$(t).offset().top-100-0},800)}}),$(document).on("change",".ecb_file_selector_select select",function(e){var t=$(this).val(),i=t.substr(t.lastIndexOf(".")+1),a=$(this).parent().next(".ecb_file_selector_preview"),n=a.data("supported-extensions").split(",");""==$(this).val()||-1===jQuery.inArray(i,n)?a.attr("src","").removeClass("show"):a.attr("src",a.data("uploadsurl")+"/"+$(this).val()).addClass("show")}),$(document).on("error",".ecb_file_selector_preview",function(){$(this).removeClass("show")}),$(document).on("change",".ecb_file_picker .cmsfp_elem",function(e){e.preventDefault();var t=$(this).val(),i=$(this).closest(".ecb_file_picker").find(".ecb_file_picker_preview");""==t?i.attr("src","").removeClass("show"):(i.attr("src",""),$.ajax({url:i.data("ajax-url")+"&showtemplate=false",method:"POST",data:{file_name:t,top_dir:i.data("top-dir"),thumbnail_width:i.data("thumbnail-width"),thumbnail_height:i.data("thumbnail-height")}}).done(function(e){e&&i.attr("src",e+"?"+Date.now()).addClass("show")}))}),$(document).on("change",".ecb_multiple_select select",function(e){var t=$(this).val()?$(this).val().join(","):"";$(this).siblings(".ecb_select_input").val(t);var i=$(this).siblings(".ecb_select_summary");if(i.length>0){var a=$(this).children("option:selected").map(function(){return $(this).text()}).get().join(", ");$(this).siblings(".ecb_select_summary").val(a);var n=$(this).siblings(".ecb_select_summary").children(".ecb_select_text");""==a?i.children(".ecb_select_text").html(n.data("empty")):i.children(".ecb_select_text").html(a)}}),$(".ecb_compact .ecb_select_edit").click(function(e){e.preventDefault(),$(this).closest(".ecb_compact").toggleClass("show")}),$(".ecb2-hide-label").parent().siblings(".pagetext").hide(),$(".ecb_repeater.sortable").sortable({items:"> *:not(.unsortable)",placeholder:"repeater-placeholder",handle:".handle",forcePlaceholderSize:!0,opacity:.8,start:function(e,t){"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave()},stop:function(e,t){$(this).find("textarea.wysiwyg").each(function(){"undefined"!=typeof tinyMCE&&(tinyMCE.execCommand("mceRemoveEditor",!1,$(this).attr("id")),tinyMCE.execCommand("mceAddEditor",!1,$(this).attr("id")),tinymce.activeEditor.show())})},create:function(e,i){$(this).hasClass("table-layout")&&t($(this));var a=setInterval(function(){$(".ecb_repeater.table-layout").each(function(){t($(this))})},1e3);setTimeout(function(){clearInterval(a)},8500),$(window).on("resize",function(){$(".ecb_repeater.table-layout").each(function(){t($(this))})})}}),$(document).on("click",".ecb2-repeater-add",function(t){t.preventDefault();var a=$(this).closest(".ecb_repeater"),n=a.find(".repeater-wrapper-template").clone(),r=a.data("highest-row")+1,s=a.data("block-name");n.removeClass("repeater-wrapper-template").addClass("repeater-wrapper").css("display",""),i(n,s,r),a.data("highest-row",r),n.find("textarea.wysiwyg").length?function(e,t){e.append(t),t.find("textarea.wysiwyg").each(function(){tinymce.EditorManager.execCommand("mceAddEditor",!0,$(this).attr("id")),tinymce.activeEditor.show()})}(a,n):a.append(n),e(a)}),$(document).on("click",".ecb2-repeater-remove",function(t){t.preventDefault();var i=$(this).closest(".ecb_repeater"),a=$(this).closest(".repeater-wrapper"),n=i.find(".repeater-wrapper").length;a.find("textarea.wysiwyg").length?function(e,t,i){t.find("textarea.wysiwyg").each(function(){i>1?(tinymce.get($(this).attr("id")).remove(),t.remove()):(editor=tinymce.get($(this).attr("id")),editor.setContent(""))})}(0,a,n):n>1?a.remove():(a.find(".repeater-field").val(""),$pagePickerSubFields=a.find(".sub-field-page_picker").find("input:hidden"),$pagePickerSubFields.hierselector({value:-1,allowcurrent:!1,allow_all:!1,use_perms:!1,for_child:!1,is_manager:1}),a.find(".cms_checkbox").prop("checked",!1)),e(i)}),$("ul.sortable-ecb2-list").each(function(){var e=$(this).closest(".ecb2-cb").find("ul.selected-items");$(this).sortable({connectWith:e,delay:150,revert:300,placeholder:"ui-state-highlight",items:"li:not(.no-sort)",helper:function(e,t){t.hasClass("selected")||t.addClass("selected").siblings().removeClass("selected");var i=t.parent().children(".selected").clone(),a=$("<li/>");return t.data("multidrag",i).siblings(".selected").remove(),a.append(i)},stop:function(e,t){var i=t.item.data("multidrag"),a=$(t.item).parent();t.item.after(i).remove(),n(a)},receive:function(e,t){var i=t.item.data("multidrag");$(this).data("max-number")&&$(this).children().length-1>$(this).data("max-number")?$(t.sender).sortable("cancel"):(r($(this)),$(i).removeClass("selected ui-state-hover").find(".sortable-remove").removeClass("hidden"))}})}),$("ul.selected-items").each(function(){var e=$(this).closest(".ecb2-cb").find("ul.available-items");$(this).sortable({connectWith:e,delay:150,revert:300,placeholder:"ui-state-highlight",stop:function(e,t){var i=$(t.item).closest(".ecb2-cb").find(".selected-items");$(t.item).removeClass("selected"),$(t.item).children(".sortable-remove").addClass("hidden"),n(i),r(i)}})}),$(document).on("click","#selected-items .sortable-remove",function(e){e.preventDefault();var t=$(this).closest("ul.selected-items"),i=$(this).closest(".ecb2-cb").find(".available-items");$(this).addClass("hidden").parent("li").removeClass("no-sort").appendTo(i),n(t),r(t)}),s($(".timepicker")),l($(".datepicker")),o($(".datetimepicker")),c($(".colorpicker")),$(".ecb2-dropzone.sortable").sortable({items:"> *:not(.unsortable)",placeholder:"dz-sortable-placeholder",handle:".dz-handle",forcePlaceholderSize:!0,opacity:.8,start:function(e,t){t.item.siblings(".dz-upload-prompt").hide()},stop:function(e,t){t.item.siblings(".dz-upload-prompt").show()}}),$(".ecb2-dropzone").each(function(e){var t=$(this).data("dropzone-url"),a=$(this).data("dropzone-values"),n=$(this).data("dropzone-resize-width"),r=$(this).data("dropzone-resize-height"),s=$(this).data("dropzone-resize-method"),l=$(this).data("dropzone-thumbnail-width"),o=$(this).data("dropzone-thumbnail-height"),c=$(this).data("dropzone-thumbnail-prefix"),u=$(this).data("dropzone-max-files"),h=$(this).data("dropzone-max-files-text"),p=$(this).find(".dropzone-preview-template").clone(),m=$(this).data("location");p.find(".dz-preview").css("display",""),n=void 0===n||0==n?null:n,r=void 0===r||0==r?null:r,s=void 0===s?"contain":s,l=void 0===l||0==l?null:l,o=void 0===o||0==o?null:o,max_new_files=void 0===u||0==u?null:u-a.length,$(this).dropzone({url:t,uploadMultiple:!0,parallelUploads:5,previewTemplate:p.html(),clickable:"#"+$(this).data("block-name")+"-upload-prompt",resizeWidth:n,resizeHeight:r,resizeMethod:s,thumbnailWidth:l,thumbnailHeight:o,maxFiles:max_new_files,dictMaxFilesExceeded:h,init:function(){$dz=$(this.element),this.on("addedfiles",function(e){$(this.element).children(".dz-upload-prompt").hide()}),this.on("successmultiple",function(e,t){var a=$(this.element);e.forEach(function(e,n){var r=a.data("block-name"),s=a.data("highest-row")+1,l=$("#"+r+"-sub-fields");t[n].success?($(e.previewElement).find(".dz-input-filename").val(e.name).attr("name",r+"[r_"+s+"][filename]"),$(e.previewElement).data("row",s),setTimeout(function(){$(e.previewElement).removeClass("dz-success")},"3000"),$newSubFields=l.find(".dz-sub-fields-template").clone(),$newSubFields.attr("id",r+"_r_"+s+"_sub_fields"),$newSubFields.removeClass("dz-sub-fields-template").addClass("dz-sub-field"),i($newSubFields,r,s),l.append($newSubFields),a.data("highest-row",s)):$(e.previewElement).addClass("dz-error").removeClass("dz-success")}),a.hasClass("sortable")&&a.sortable("enable"),d(this)}),this.on("maxfilesexceeded",function(){d(this)}),this.on("removedfile",function(e){var t=$(e.previewElement).data("row");t&&$("#"+$dz.data("block-name")+"_r_"+t+"_sub_fields").remove(),d(this)}),a.forEach(function(e,t){""!=e&&this.displayExistingFile({name:e,size:12345},m+c+e,null,null,!1)}),$dz.children(".dz-preview").each(function(e){var t=$(this).find(".dz-input-filename"),i=e+1,a=$dz.data("block-name");""==t.val()&&t.val($(this).find(".dz-filename span").html()),""==t.attr("name")&&(t.attr("name",a+"[r_"+i+"][filename]"),t.attr("id",a+"_r_"+i+"_filename")),""==$(this).data("row")&&$(this).data("row",i)}),d(this)}})}),$(document).on("click",".dz-edit",function(e){e.preventDefault();var t=$(this).closest(".ecb2-dropzone").data("blockName"),i=$(this).closest(".dz-preview").data("row");$("#"+t+"_r_"+i+"_sub_fields").dialog({modal:!0,width:600,title:"Edit details",buttons:{Ok:function(){$(this).dialog("close")}},create:function(e,t){a($(e.target))},open:function(e,t){$(e.target).find(".repeater-field").each(function(){$(this).hasClass("wysiwyg")&&(tinymce.EditorManager.execCommand("mceAddEditor",!0,$(this).attr("id")),tinymce.activeEditor.show())})},close:function(e,t){$(e.target).dialog("destroy"),a($(e.target)),$(e.target).appendTo("#"+$(this).data("sub-field-parent"))}})})});